<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Posts on // √Ålex Go{,5z}</title><link>https://agonzalezro.github.io/posts/</link><description>Recent content in Posts on // √Ålex Go{,5z}</description><generator>Hugo -- gohugo.io</generator><language>en</language><lastBuildDate>Tue, 18 Oct 2022 00:00:00 +0000</lastBuildDate><atom:link href="https://agonzalezro.github.io/posts/index.xml" rel="self" type="application/rss+xml"/><item><title>Why imposter syndrome can be your best friend</title><link>https://agonzalezro.github.io/posts/imposter_syndrome/</link><pubDate>Tue, 18 Oct 2022 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/imposter_syndrome/</guid><description>The infamous imposter syndrome is always perceived as a bad thing but if you ally with it you could become Best Friends Forever (aka BFF).
I am pretty sure that in my case the imposter syndrome has helped me to develop my abilities, especially in tech which is my &amp;ldquo;area of knowledge&amp;rdquo;.
Life is split into stages, some of those stages are better for your growth than others. There are times when you think you are the king of the world and that you already know everything you need to know but if you are lucky enough to pass through that phase you will realize that you didn&amp;rsquo;t have all the answers.</description><content type="html"><![CDATA[<p>The infamous <em>imposter syndrome</em> is always perceived as a bad thing but if you ally with it you could become Best Friends Forever (aka BFF).</p>
<p>I am pretty sure that in my case the <em>imposter syndrome</em> has helped me to develop my abilities, especially in tech which is my &ldquo;area of knowledge&rdquo;.</p>
<p>Life is split into stages, some of those stages are better for your growth than others. There are times when you think you are the king of the world and that you already know everything you need to know but if you are lucky enough to pass through that phase you will realize that you didn&rsquo;t have all the answers. In tech, this stage is common among other situations when you go out from the university knowing Java and you think that&rsquo;s enough for earning the also infamous 6-figure-salary. It isn&rsquo;t new either, it&rsquo;s called the &ldquo;Dunning-Kruger effect&rdquo;; from Wikipedia:</p>
<blockquote>
<p>The Dunning‚ÄìKruger effect is a cognitive bias whereby people with low ability, expertise, or experience regarding a certain type of a task or area of knowledge tend to overestimate their ability or knowledge. Some researchers also include in their definition the opposite effect for high performers: their tendency to underestimate their skills.</p>
</blockquote>
<p>That&rsquo;s good news for you, if you have reached a state where <em>imposter syndrome</em> is hitting after you thought you were the king it might mean that you are on the curve to the top after the &ldquo;Valley of Despair&rdquo;; also from Wikipedia:</p>
<p><img alt="Dunning Kruger Effect graph, from wikipedia" src="/dunning_kruger_effect_from_wikipedia.svg"></p>
<p>Now that you are not the person that knows more about the subject being discussed in the room and you have two options here:</p>
<ol>
<li>Let <em>imposter syndrome</em> bring you down OR</li>
<li>Leverage <em>imposter syndrome</em> in order to become better at the matter at hand.</li>
</ol>
<p>If you decide to go for option #2 you have a huge advantage: you already know that there are things you don&rsquo;t know and you are in a room full of people that can help you get better at it. Use this opportunity!</p>
<p>I felt/feel like that several times but I prefer to take it as an opportunity to ask questions &amp; learn. Knowing that you are not there yet can be fuel to get you to where you want to be in the future or can just bring you down and depress you.</p>
<p>Believe it or not, everybody was there at some point. You have two options here, either you use <em>imposter syndrome</em> as a catapult to success or you don‚Äôt. It‚Äôs up to you and if you decide not to do it that‚Äôs also fine, but I know what I would choose.</p>
]]></content></item><item><title>How to prepare the Certified Kubernetes Administrator exam</title><link>https://agonzalezro.github.io/posts/cka/</link><pubDate>Mon, 16 Apr 2018 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/cka/</guid><description>Finally last weekend I did the CKA exam, I was procrastinating it a bit in part because I didn&amp;rsquo;t know what to expect since Kubernetes is huge and I thought that each day extra I spend reading about it would help me.
TLDR; I did pass the exam and if you work daily with Kubernetes or variants as Openshift you will be ok, they are not trying to catch you in some weird question that not even Kelsey would know how to answer üòÄ</description><content type="html"><![CDATA[<p>Finally last weekend I did the CKA exam, I was procrastinating it a bit in part because I didn&rsquo;t know what to expect since Kubernetes is huge and I thought that each day extra I spend reading about it would help me.</p>
<p>TLDR; I did pass the exam and if you work daily with Kubernetes or variants as Openshift you will be ok, they are not trying to catch you in some weird question that not even <a href="https://twitter.com/kelseyhightower">Kelsey</a> would know how to answer üòÄ</p>
<p><img alt="CKA certification" src="/devops/cka.png"></p>
<h2 id="preparation">Preparation</h2>
<p>Giving the long quantity of topics that could be covered in the exam I have used several resources to study it.
I will try to sort this in a way that makes sense if you have no knowledge about Kubernetes at all, if you are already familiarized with it you probably can skip some of the links.</p>
<p>First of all you will need to know the basic Kubernetes resources, if you are a video fan maybe this video could help you: <a href="https://www.youtube.com/embed/K_Kh4LMiiqQ">&ldquo;From pets to cattle, the way of Kubernetes&rdquo;</a> (no spam üò¨) but after watching it you will need to get more in depth, for doing so I recommend the book <a href="http://shop.oreilly.com/product/0636920043874.do">&ldquo;Kubernetes: Up and Running&rdquo;</a>.</p>
<p>Now that you know the basics probably you will want to test it, you have several ways for doing it: minikube, creating a cluster in GKE, etc&hellip; but if you don&rsquo;t want to bother about it yet, use <a href="https://www.katacoda.com/">Katacoda</a> and try to finish some of the free Scenarios they have there.</p>
<p>You are almost there but if you are missing troubleshooting experience because you never administrated a Kubernetes cluster take a look to: <a href="http://shop.oreilly.com/product/0636920064947.do">&ldquo;Kubernetes Cookbook&rdquo;</a>; this book is pretty focused on pragmatic problems, it will definitely help you in case you need to troubleshoot stuff and try to follow <a href="https://github.com/kelseyhightower/kubernetes-the-hard-way">&ldquo;Kubernetes the hard way&rdquo;</a> that would help you a lot to understand how to install or fix the Kubernetes components.</p>
<p>If have read all the previous links but you still want more, take a look to the official documentation at <a href="https://kubernetes.io/">kubernetes.io</a> to review all the concepts.</p>
<h2 id="the-day-of-the-exam">The day of the exam</h2>
<p>Part of my anxiety regarding the exam was that I didn&rsquo;t know what to expect after sitting in my PC at 3pm, what would happen if my browser gets blocked? If I can&rsquo;t understand a question? If I break my cluster? What&rsquo;s going to be my &ldquo;IDE&rdquo;?
I think some of these questions could be easily answered by the Linux Foundation in form of a video explaining how to do the exam, but I couldn&rsquo;t find anything similar so I will try to help you here:</p>
<ul>
<li>
<p>Before the exam, the examiner will ask you yo <strong>clean your desk and drawers</strong>, completely, I had some books in drawers that were not covered by the cam and I had to move them. I also had an schedule in a wall and I had to unglue it.</p>
</li>
<li>
<p>The <strong>place should be quiet</strong> because even if you usually work with headphones you will not be allowed to use them.</p>
</li>
<li>
<p>The examiner will ask you to see all the room, even under the desk.</p>
</li>
<li>
<p>The <strong>examiner will not talk to you by voice, only by chat</strong>. He/she will hear you because you will need to share the screen and micro. When you do that he will ask you to show open processes et al to be sure you are not copying. I found this a little bit excessive, but&hellip; rules and probably some previous cheaters (shame on you!).</p>
</li>
<li>
<p>The exam happens in a Chrome tab, the left side will show you the questions and the percentage it covers and you will be able to jump from one to another. All the questions are atomic. The right side is for the shell, I tried to use tmux there, but it was pretty difficult inside a browser terminal. You can also have a popup with notes.</p>
</li>
<li>
<p>After running a command in the shell it got blocked and I panicked, I went to my Inbox to write an email to support but luckily after few second (maybe a minute or two but it looked like a long time to me) it went back. I let the examiner know just in case he/she saw me in the email, and that&rsquo;s it.</p>
</li>
<li>
<p>You can <strong>only open a tab with kubernetes.io</strong> and use its search box, no Google. In the past it seems it wasn&rsquo;t like this. It&rsquo;s ok because the answer is usually there, but you need to get used to it, maybe try it out during the preparation.</p>
</li>
<li>
<p><strong>It&rsquo;s ok to request a pause</strong>, but careful because the time doesn&rsquo;t stop.</p>
</li>
<li>
<p>You have three hours to finish the exam, <strong>if you get blocked it‚Äôs better to skip</strong> that question for now and retake it later.</p>
</li>
</ul>
<h2 id="the-wait">The wait</h2>
<p>I did the exam last Saturday afternoon, from 3pm to 6pm and when I work up this morning I already had the result in my Inbox so you will not need to wait a lot for it, probably during work days it&rsquo;s going to be even quicker.</p>
<p><img alt="that&rsquo;s all folks" src="/devops/thatsall.jpg"></p>
<p>So, that&rsquo;s it from me.
If you are interested in Kubernetes and you work with it often you will not have any trouble passing the exam, however, I understand that giving the huge range of things that they could ask you the exam can be intimidating, trust yourself and you will be ok!
If you do the exam and this helps you somehow or you just want to let me know anything, <a href="https://twitter.com/agonzalezro">please ping me on @agonzalezro</a>!</p>
]]></content></item><item><title>Projects I didn't do in 2017</title><link>https://agonzalezro.github.io/posts/projects_2017/</link><pubDate>Sun, 14 Jan 2018 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/projects_2017/</guid><description>If you know me you probably know that I am always complaining that I want to start some pet project that could give me some kind of income. The income is a nice incentive, but not for the income itself if not because it would be really nice to have somebody paying for a project that you started from scratch.
In 2017 I had some ideas that after further investigation or after just chatting with some friend about them I decided to not even start or think about them again.</description><content type="html"><![CDATA[<p>If you know me you probably know that I am always complaining that I want to start some pet project that could give me some kind of income.
The income is a nice incentive, but not for the income itself if not because it would be really nice to have somebody paying for a project that you started from scratch.</p>
<p>In 2017 I had some ideas that after further investigation or after just chatting with some friend about them I decided to not even start or think about them again.</p>
<p>Why am I sharing them? Because to be fair I don&rsquo;t think I will never start them, also, maybe we can start a good brainstorm here!</p>
<figure><img src="/lazy-cat.jpg"
    alt="A lazy cat"><figcaption>
      <p>Lazy cat proudly brought to you by huffingtonpost</p>
    </figcaption>
</figure>

<h2 id="tool-to-review-tweets">Tool to review Tweets</h2>
<p>When I was working at Jobandtalent we had several problems deciding what to tweet in the <a href="https://twitter.com/jobandtalentEng">eng account</a>. This toold could help you to decide what to publish, fix errors on the tweets, etc (as you would do with Github PRs).</p>
<p>In the future, it should be available as well for Instagram, Facebook, etc..</p>
<p>Also, it should support bots via API to add comments, for example, about the grammar of the publication.</p>
<p>I started this one here: <a href="http://chimpin.io/">chimpin.io</a> but the interest was near to zero.</p>
<h2 id="adventure-tech-book">Adventure tech book</h2>
<p>A tech book in the style of <a href="https://en.wikipedia.org/wiki/Choose_Your_Own_Adventure">&ldquo;Choose your own adventure&rdquo;</a>.</p>
<p>It would be a book that would immerse you in an adventure where you should take tech decisions: would you use git or rather copy/paste the folder adding a suffix? One of them will end up in dead, you decide.</p>
<h2 id="search-adventures">Search adventures</h2>
<p>Something like booking but for activities, ex: I want to do karting in Madrid next Saturday, show me the deals.</p>
<p>It would scrape the deals from different sources (not sure if it would even be legal, but I didn&rsquo;t give it that much thought).</p>
<h2 id="track-your-friends">Track your friends</h2>
<p>I am pretty bad at keeping in touch with my friends/colleagues. This tool will remember you through a simple algorithm when you need to do it! But&hellip; maybe I should fix myself and not use an app like this one üò¨</p>
<h2 id="status-page">Status page</h2>
<p>Yet another application that let you know create a status page for your site.
It should be reliable, support theming and have nice graphs about the uptimes.</p>
<h2 id="logstash-rescuetime">Logstash rescuetime</h2>
<p>I use <a href="https://www.rescuetime.com/">rescuetime</a> to track where do I spend my time with the computer. I thought that having that information in logstash would help me to create nice dashboards about my performance.</p>
<p>Probably I would spend more time creating the nice dashboards than doing real job.</p>
<h2 id="crypto-present">Crypto present</h2>
<p>Nice real life packaging for cryptos. Imagine you are going to a birthday and instead of giving a 20 bucks present you give them a nice package with a hash code that represent its crypto? Wouldn&rsquo;t that be nice? (Or not, that&rsquo; the problem with crypto).</p>
<h2 id="starter-pack-for-wood">Starter pack for wood</h2>
<p>Sell packs to start working with wood. For example: a knife + a piece of wood + some instruction to create a spoon. All of it presented in a beautful package.</p>
<p>The problem with this is that the recurrent users after they have the tools is going to be minimal.</p>
<h2 id="web-for-creating-real-life-exams">Web for creating real life exams</h2>
<p>Teachers spend a lot of time preparing their exams, this tool would help them (collaborative) to tag exercises and the time it needs to be done. With a proper base of users they could plug&amp;play the exams.</p>
<p>Imagine a Spanish teacher that want to do an exam about &ldquo;infinitive form&rdquo;, the tool could show some exercise and he/she will decide what to use and how many do they need depending on the time the exam should take.</p>
<p>I have some other ideas but they are fully techie so not that interesting for my purpose: ansible vendor tool, a Kubernetes bot for <a href="agonzalezro.github.com/botella">botella</a> (<a href="https://github.com/agonzalezro/agonzalezro.github.io/blob/kubernetes-for-botella/content/kubernetes/kubernetes-for-botella.md">this one is almost done</a>, but the usability isn&rsquo;t that good üòÖ), <code>pprof</code> exporter for Prometheus, ditto for Nats&hellip;</p>
]]></content></item><item><title>How to read a Reader twice</title><link>https://agonzalezro.github.io/posts/tee_reader/</link><pubDate>Sat, 13 Jan 2018 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/tee_reader/</guid><description>Some time ago I read about TeeReader but to be fair, I didn&amp;rsquo;t give it that much thought. However, few month back I saw a video by @francesc and his nice use case and I wrote down a new item in my mental TODO list about things I wanted to use.
Last week I had the chance to do it; we have a service that requires reading a request body to check for a Status field and also it requires to store the raw request.</description><content type="html"><![CDATA[<p>Some time ago I read about <a href="https://golang.org/pkg/io/#TeeReader"><code>TeeReader</code></a> but to be fair, I didn&rsquo;t give it that much thought. However, few month back I saw <a href="https://www.youtube.com/watch?v=c5ufcpTGIJM&list=PL64wiCrrxh4Jisi7OcCJIUpguV_f5jGnZ">a video</a> by <a href="https://twitter.com/francesc">@francesc</a> and his nice use case and I wrote down a new item in my mental TODO list about things I wanted to use.</p>
<p>Last week I had the chance to do it; we have a service that requires reading a request body to check for a <code>Status</code> field and also it requires to store the raw request.</p>
<p>What we were doing in the first iteration was unmarshalling the full payload into a struct and marshal the struct as the raw data. This process wasn&rsquo;t very reliable because it&rsquo;s pretty easy to lose information in during the un/marshalling.</p>
<p>To solve it we had two options:</p>
<ol>
<li>Read all the body, store it in a variable and use that var as raw data and as an input to the <code>Unmarshal</code> call. Not very neat as you are not taking advantages of the <a href="https://blog.golang.org/json-and-go#TOC_7.">decoding streams</a>.</li>
<li>Use the <code>TeeReader</code>.</li>
</ol>
<p>Here is an example (not with real names tho.) of what we end up doing:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-go" data-lang="go"><span style="display:flex;"><span><span style="color:#66d9ef">type</span> <span style="color:#a6e22e">Payload</span> <span style="color:#66d9ef">struct</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">Status</span> <span style="color:#66d9ef">int</span>
</span></span><span style="display:flex;"><span>}
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">func</span> <span style="color:#a6e22e">getStatusAndReason</span>(<span style="color:#a6e22e">r</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">Reader</span>) (<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">error</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">buf</span> <span style="color:#a6e22e">bytes</span>.<span style="color:#a6e22e">Buffer</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">tee</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">io</span>.<span style="color:#a6e22e">TeeReader</span>(<span style="color:#a6e22e">r</span>, <span style="color:#f92672">&amp;</span><span style="color:#a6e22e">buf</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">payload</span> <span style="color:#a6e22e">Payload</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">err</span> <span style="color:#f92672">:=</span> <span style="color:#a6e22e">json</span>.<span style="color:#a6e22e">NewDecoder</span>(<span style="color:#a6e22e">tee</span>).<span style="color:#a6e22e">Decode</span>(<span style="color:#f92672">&amp;</span><span style="color:#a6e22e">payload</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">payload</span>.<span style="color:#a6e22e">Status</span>, <span style="color:#a6e22e">buf</span>.<span style="color:#a6e22e">String</span>(), <span style="color:#a6e22e">err</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>I hope you liked our use case, and in case you would do in any other way, please, <a href="https://twitter.com/agonzalezro">do let me know</a>! It&rsquo;s always nice learning from your experiences üòÄ</p>
]]></content></item><item><title>Closing 2016, a list of talks I gave</title><link>https://agonzalezro.github.io/posts/2016/</link><pubDate>Sun, 29 Jan 2017 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/2016/</guid><description>Thanks @rais38 for the photo!
We are almost at the end of January but I didn&amp;rsquo;t want to end the first month of the year without doing a small recap of the talks I gave last year.
When I moved to Spain at the end of 2015 I said to myself that I didn&amp;rsquo;t want to forget the little English I knew so I needed to force myself to keep traveling outside of Spain and to do some public speaking.</description><content type="html"><![CDATA[<figure><img src="/rafa.jpg"
    alt="A cow"><figcaption>
      <p>Thanks @rais38 for the photo!</p>
    </figcaption>
</figure>

<p>We are almost at the end of January but I didn&rsquo;t want to end the first month of the year without doing a small recap of the talks I gave last year.</p>
<p>When I moved to Spain at the end of 2015 I said to myself that I didn&rsquo;t want to forget the little English I knew so I needed to force myself to keep traveling outside of Spain and to do some public speaking. The public speaking bit is for two reason: keep forcing myself to speak English and&hellip; to lose my fear about talking English in front of a bunch of people you don&rsquo;t know about a tech that they probably know better than you.</p>
<p>I could do it much better than I did, but I am happy with the results.</p>
<h2 id="my-english-talks">My English talks</h2>
<h3 id="custom-volume-plugins--kubeconhttpskubeconio">Custom Volume Plugins @ <a href="https://kubecon.io">Kubecon</a></h3>
<p><em><a href="https://www.youtube.com/watch?v=33VzHXuuRs4">Video</a> &amp; <a href="https://speakerdeck.com/agonzalezro/custom-volume-plugins">slides</a></em></p>
<p>I prepared this talk a lot, but I was pretty nervous on stage I did a terrible job. Some people said that they learn a lot of new concepts, but they were just trying to be friendly :) Probably I underestimated the pressure behind a Kubecon talk and I will fix this in the future.</p>
<h3 id="python-kubernetes-and-friends--pygrunnhttpwwwpygrunnorg">Python, Kubernetes and friends @ <a href="http://www.pygrunn.org/">PyGrunn</a></h3>
<p><em><a href="https://www.youtube.com/watch?v=0tsaMVoydDg">Video</a> &amp; <a href="https://speakerdeck.com/agonzalezro/python-kubernetes-and-friends">Slides</a></em></p>
<p>I gave this in the best (IMHO, but I could be biased) Python conference in the Netherlands, it went pretty well, I knew the things I did pretty badly in my previous talk at Kubeconf and I tried to fix the problems. However, if you check the video and you can give me some advice, feel free.</p>
<h3 id="from-pets-to-cattle-the-way-of-kubernetes">From pets to cattle, the way of Kubernetes</h3>
<p><em><a href="https://www.youtube.com/watch?v=K_Kh4LMiiqQ">Video</a> &amp; <a href="https://speakerdeck.com/agonzalezro/from-pets-to-cattle-the-way-of-kubernetes">Slides</a></em></p>
<p>This talk was in Spain, but since it was a big conference I gave it in English for non-Spanish speakers. I think the talk was ok, I got a 4 out 5 in their feedback tool, but it seems I didn&rsquo;t attach the people because nobody asking anything at the end. Out of camera I got several questions tho.</p>
<h2 id="and-the-spanish-ones">And the Spanish ones</h2>
<p>All these talks were internal Jobandtalent talks for my ex-colleagues, I hope it helped them, they definitely helped me, it was a trusty environment and the questions were really interesting. You probably wouldn&rsquo;t ask that much in a conference but it helps the speaker (in this case me) to improve.</p>
<h3 id="go-101--jobandtalenthttpwwwjobandtalentcom">Go 101 @ <a href="http://www.jobandtalent.com/">Jobandtalent</a></h3>
<p><em><a href="https://www.youtube.com/watch?v=zaywpuLV4BY">Video</a> &amp; <a href="https://speakerdeck.com/agonzalezro/go-101-updated">Slides</a></em></p>
<h3 id="kubernetes-101--jobandtalenthttpwwwjobandtalentcom">Kubernetes 101 @ <a href="http://www.jobandtalent.com/">Jobandtalent</a></h3>
<p><em><a href="https://www.youtube.com/watch?v=5YmhMM_q4uI">Video</a> &amp; <a href="https://speakerdeck.com/agonzalezro/kubernetes-101">Slides</a></em></p>
<h3 id="docker-101--jobandtalenthttpwwwjobandtalentcom">Docker 101 @ <a href="http://www.jobandtalent.com/">Jobandtalent</a></h3>
<p><em><a href="https://speakerdeck.com/agonzalezro/docker-101">Slides</a></em></p>
<p>Out of that list I gave some other, for example, about <a href="https://github.com/agonzalezro/goqui/blob/master/examples/neo4j_intro_slides.neo4j">Neo4J</a> and a workshop with my friend <a href="https://twitter.com/ipedrazas">@ipedrazas</a> about Kubernetes &amp; Docker, here, in Spain. Also, I started <a href="https://meetup.com/mad-scalability">mad Scalability</a> and I am quite happy with about it!</p>
<p>I will try to prepare some CFP in 2017, but as today I see it pretty difficult because of reasons :)</p>
<p>As I said at the beginning of the post, one of the reasons why I tried to do public speaking is to improve at it, you if you have any advice <a href="https://twitter.com/agonzalezro">share it with me</a> please!</p>
]]></content></item><item><title>Scheduling Your Kubernetes Pods With Elixir</title><link>https://agonzalezro.github.io/posts/elixir-scheduler/</link><pubDate>Mon, 16 Jan 2017 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/elixir-scheduler/</guid><description>This was originally posted on deis.com.
Kelsey Hightower gave a really interesting talk at ContainerSched about how to create your own scheduler using the Kubernetes HTTP API.
The talk was awesome. It&amp;rsquo;s incredible to see what kind of things you can do with a base system as good as Kubernetes.
However, I missed one thing. The example provided by Kelsey was a Go application. Which is the main language used with Kubernetes.</description><content type="html"><![CDATA[<blockquote>
<p>This was originally posted on <a href="https://deis.com/blog/2016/scheduling-your-kubernetes-pods-with-elixir/">deis.com</a>.</p>
</blockquote>
<p><a href="https://twitter.com/kelseyhightower">Kelsey Hightower</a> gave a really interesting talk at <a href="https://skillsmatter.com/conferences/7208-containersched-2015">ContainerSched</a> about how to create your own scheduler using the Kubernetes HTTP API.</p>
<p>The talk was awesome. It&rsquo;s incredible to see what kind of things you can do with a base system as good as Kubernetes.</p>
<p>However, I missed one thing. The <a href="https://github.com/kelseyhightower/scheduler">example</a> provided by Kelsey was a Go application. Which is the main language used with Kubernetes. So, if you look at that code without any context, you might think it&rsquo;s using some kind of Kubernetes internal packages. But it&rsquo;s not! It&rsquo;s a standalone piece of code that happens to make some HTTP calls.</p>
<p>To illustrate this point, I decided to write my own scheduler, in a different language. In my case, <a href="http://elixir-lang.org/">Elixir</a>, because that&rsquo;s the language I happen to be learning at the moment.</p>
<p>This post isn&rsquo;t an intro to Elixir, but the code should be easy to follow.</p>
<p>Also, I&rsquo;m going to use <code>localhost</code> when accessing the Kubernetes API. Why? For simplicity. If we run <code>kubectl proxy</code> on a computer connected to the Kubernetes master, we will not need to deal with authorization, hosts, and so on. The <code>proxy</code> command will do it for us.</p>
<p>So, let&rsquo;s dive in.</p>
<h2 id="get-a-list-of-unscheduled-jobs">Get a List of Unscheduled Jobs</h2>
<p>To start off with, we need a pod for our scheduler to schedule.</p>
<p>By default, Kubernetes will schedule all your pods. So, we need to create a unscheduled pod and we need to indicate to Kubernetes that we don&rsquo;t want our pod to get scheduled.</p>
<p>So, create a file called <code>pod.yml</code> and put this inside:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#f92672">apiVersion</span>: <span style="color:#ae81ff">v1</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">kind</span>: <span style="color:#ae81ff">Pod</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">metadata</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">name</span>: <span style="color:#ae81ff">custom</span>
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">annotations</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">scheduler.alpha.kubernetes.io/name</span>: <span style="color:#ae81ff">myOwnScheduler</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">spec</span>:
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">containers</span>:
</span></span><span style="display:flex;"><span>    - <span style="color:#f92672">name</span>: <span style="color:#e6db74">&#34;nginx&#34;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#f92672">image</span>: <span style="color:#e6db74">&#34;nginx:1.10.0&#34;</span>
</span></span></code></pre></div><p>Notice the <code>scheduler.alpha.kubernetes.io/name</code> annotation we use to specify that our scheduler (that we call <code>myOwnScheduler</code>) will be handling this pod.</p>
<p>Now, let&rsquo;s create the pod from the definition file:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>kubectl create -f pod.yml
</span></span></code></pre></div><p>After you&rsquo;ve done this, there will be an unscheduled job waiting for us inside Kubernetes. Why unscheduled? Because our pod says it wants to be scheduled by the <code>myOwnScheduler</code> scheduler, but we&rsquo;ve not created it yet, so Kubernetes can&rsquo;t schedule it.</p>
<p>So, let&rsquo;s build our scheduler.</p>
<p>First, our scheduler must be able to grab this unscheduled job from the API.</p>
<p>Here&rsquo;s the function I wrote to do that:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> unscheduled_pods <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  is_managed_by_us <span style="color:#f92672">=</span> <span style="color:#f92672">&amp;</span>(get_in(&amp;1, [<span style="color:#e6db74">&#34;metadata&#34;</span>, <span style="color:#e6db74">&#34;annotations&#34;</span>, <span style="color:#e6db74">&#34;scheduler.alpha.kubernetes.io/name&#34;</span>]) <span style="color:#f92672">==</span> <span style="color:#a6e22e">@name</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  resp <span style="color:#f92672">=</span> <span style="color:#a6e22e">HTTPoison</span><span style="color:#f92672">.</span>get! <span style="color:#e6db74">&#34;http://127.0.0.1:8001/api/v1/pods?fieldSelector=spec.nodeName=&#34;</span>
</span></span><span style="display:flex;"><span>  resp<span style="color:#f92672">.</span>body
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">|&gt;</span> <span style="color:#a6e22e">Poison</span><span style="color:#f92672">.</span>decode!
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">|&gt;</span> get_in([<span style="color:#e6db74">&#34;items&#34;</span>])
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">|&gt;</span> <span style="color:#a6e22e">Enum</span><span style="color:#f92672">.</span>filter(is_managed_by_us)
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">|&gt;</span> <span style="color:#a6e22e">Enum</span><span style="color:#f92672">.</span>map(<span style="color:#f92672">&amp;</span>(get_in(&amp;1, [<span style="color:#e6db74">&#34;metadata&#34;</span>, <span style="color:#e6db74">&#34;name&#34;</span>])))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>As you can see we are using <code>127.0.0.1</code> to query our API, this is posible thanks to the <code>kubectl proxy</code> command we mentioned in the intro.</p>
<p>This code grabs the name of all the pods that are waiting to be scheduled inside Kubernetes. It then uses the <code>is_managed_by_us</code> function to see whether the <code>@name</code> attribute is set to <code>myOwnScheduler</code>. If this is true, the pod has indicated that it should be managed by our scheduler.</p>
<h2 id="an-elixir-introduction">An Elixir Introduction</h2>
<p>I said I wouldn&rsquo;t explain Elixir, but I will just comment on three piece of syntax.</p>
<p>The <code>|&gt;</code> in the code above is a pipe, like the <code>|</code> character from a shell script. Using this passes the result from the left side as a parameter to the function on the right side. In this way return values can be piped through functions.</p>
<p>The <code>&amp;</code> character marks an <a href="https://en.wikipedia.org/wiki/Anonymous_function">anonymous function</a>, i.e. a function that we define inline as an expression. And <code>&amp;1</code> refers the first parameter received by the function.</p>
<p>We can also use an anonymous function as parameter to another function. As we are doing, in the <code>map</code> call.</p>
<h2 id="get-a-list-of-available-nodes">Get a List of Available Nodes</h2>
<p>Our <code>unscheduled_pods</code> function gets us a list of pods that have not been scheduled yet. So next up, we can bind them to our nodes. That is, we tell our containers to run on particular nodes.</p>
<p>But wait, how do we know what nodes are available?</p>
<p>We&rsquo;ll need to grab those as well, like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> nodes <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  resp <span style="color:#f92672">=</span> <span style="color:#a6e22e">HTTPoison</span><span style="color:#f92672">.</span>get! <span style="color:#e6db74">&#34;http://127.0.0.1:8001/api/v1/nodes&#34;</span>
</span></span><span style="display:flex;"><span>  resp<span style="color:#f92672">.</span>body
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">|&gt;</span> <span style="color:#a6e22e">Poison</span><span style="color:#f92672">.</span>decode!
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">|&gt;</span> get_in([<span style="color:#e6db74">&#34;items&#34;</span>])
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">|&gt;</span> <span style="color:#a6e22e">Enum</span><span style="color:#f92672">.</span>map(<span style="color:#f92672">&amp;</span>(get_in(&amp;1, [<span style="color:#e6db74">&#34;metadata&#34;</span>, <span style="color:#e6db74">&#34;name&#34;</span>])))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>This code will return a list of all nodes.</p>
<p>We could potentially request a lot more information from the API at this point, but for what we&rsquo;re building, it&rsquo;s not necessary. If you want to now what extra information is available, <a href="http://kubernetes.io/kubernetes/third_party/swagger-ui/#!/api%2Fv1/listNamespacedNode">check the documentation for this endpoint</a>.</p>
<h2 id="the-bind-function">The Bind Function</h2>
<p>So let&rsquo;s review.</p>
<p>We have a list of all the unscheduled jobs that we are supposed to manage. And we have a list of all the nodes we can schedule jobs to.</p>
<p>But how do we actually schedule a pods on a node?</p>
<p>We call the bind endpoint, like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> bind(pod_name, node_name) <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  url <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;http://127.0.0.1:8001/api/v1/namespaces/default/pods/</span><span style="color:#e6db74">#{</span>pod<span style="color:#e6db74">}</span><span style="color:#e6db74">/binding&#34;</span>
</span></span><span style="display:flex;"><span>  payload <span style="color:#f92672">=</span> %{
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;apiVersion&#34;</span>: <span style="color:#e6db74">&#34;v1&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;kind&#34;</span>: <span style="color:#e6db74">&#34;Binding&#34;</span>,
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;metadata&#34;</span>: %{
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;name&#34;</span>: pod_name,
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;target&#34;</span>: %{
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;apiVersion&#34;</span>: <span style="color:#e6db74">&#34;v1&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;kind&#34;</span>: <span style="color:#e6db74">&#34;Node&#34;</span>,
</span></span><span style="display:flex;"><span>      <span style="color:#e6db74">&#34;name&#34;</span>: node_name,
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>  headers <span style="color:#f92672">=</span> [{<span style="color:#e6db74">&#39;content-type&#39;</span>, <span style="color:#e6db74">&#39;application/json&#39;</span>}]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">HTTPoison</span><span style="color:#f92672">.</span>post! url, payload <span style="color:#f92672">|&gt;</span> <span style="color:#a6e22e">Poison</span><span style="color:#f92672">.</span>encode!, headers
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">IO</span><span style="color:#f92672">.</span>puts <span style="color:#e6db74">&#34;</span><span style="color:#e6db74">#{</span>pod_name<span style="color:#e6db74">}</span><span style="color:#e6db74"> pod scheduled in </span><span style="color:#e6db74">#{</span>node_name<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>But before we can use this function, we need a scheduling strategy.</p>
<h2 id="scheduling-strategy">Scheduling Strategy</h2>
<p>For our simple scheduler, we will go with a random scheduling strategy.</p>
<p>In effect, we schedule each pod on a random node. Multiple pods might even end up on the same node.</p>
<p>Here&rsquo;s how we do that:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> schedule(pods) <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  pods
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">|&gt;</span> <span style="color:#a6e22e">Enum</span><span style="color:#f92672">.</span>each(<span style="color:#f92672">&amp;</span>(bind(&amp;1, <span style="color:#a6e22e">Enum</span><span style="color:#f92672">.</span>random(nodes))))
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>Of course, this is very basic, and there are much better ways to maximise the resources we have available to us. But we&rsquo;re building this as a learning exercise. Feel free to extend this code if you want to take things further.</p>
<p>Some ideas to get you going:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Round-robin_scheduling">Round-robin</a> pod scheduling.</li>
<li>Implement your own version of Kubernete&rsquo;s load-aware scheduling.</li>
<li>Annotate the pods with some extra information, for example: cluster.type: raspberry if you want to send them to the Raspberry Pi nodes in your cluster.</li>
<li>You could use some external source of truth, e.g. Nagios, to determine which nodes to schedule jobs on.</li>
</ul>
<h2 id="putting-everything-together">Putting Everything Together</h2>
<p>Now we have everything in place, a <code>main</code> function is all that&rsquo;s needed:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-elixir" data-lang="elixir"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> main(_args) <span style="color:#66d9ef">do</span>
</span></span><span style="display:flex;"><span>  unscheduled_pods
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">|&gt;</span> schedule
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">end</span>
</span></span></code></pre></div><p>Now you are able to run your program!</p>
<p>A simple <code>elixir your_script.exs</code> should do it, if you have all the dependencies. But you probably don&rsquo;t, so I recommend you follow the Usage section in <a href="https://github.com/agonzalezro/escheduler#usage">the README</a> for the code that accompanies this post.</p>
<h2 id="wrap-up">Wrap Up</h2>
<p>For a most things, you probably don&rsquo;t want to write your own scheduler. The one provided by Kubernetes is good for so many things.</p>
<p>But if you want to do something the default Kubernetes scheduler can&rsquo;t do, it&rsquo;s not as difficult as you might think to write your own and slot it in, and continue to take advantage of everything Kubernetes has to offer.</p>
<p>I&rsquo;ve put my code up for <a href="https://github.com/agonzalezro/escheduler">my Elixir scheduler</a>, on GitHub in case you want to check it out. This repository has everything you need to follow along with this post, from the YAML pod definition to the scheduler itself.</p>
]]></content></item><item><title>Save hook for major modes</title><link>https://agonzalezro.github.io/posts/save-hook/</link><pubDate>Thu, 05 May 2016 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/save-hook/</guid><description>One of the things I like the most about Go is its go fmt tool. I don&amp;rsquo;t worry about formatting my code while I am writing it because I know that fmt is going to be there and it will do the work for me later.
Said that, the Go layer for Spacemacs is the one that is going to run it for you. Sometimes we need to deal with languages that don&amp;rsquo;t have this functionality, in my case, I found this issue working with Elixir &amp;amp; Ruby (happily Python forces you to write well :D).</description><content type="html"><![CDATA[<p>One of the things I like the most about Go is its <code>go fmt</code> tool. I don&rsquo;t worry about formatting my code while I am writing it because I know that <code>fmt</code> is going to be there and it will do the work for me later.</p>
<p>Said that, the Go layer for Spacemacs is the one that is going to run it for you. Sometimes we need to deal with languages that don&rsquo;t have this functionality, in my case, I found this issue working with Elixir &amp; Ruby (happily Python forces you to write well :D).</p>
<p>Since I got really used to the <code>fmt</code> tool I wanted a similar solution for those languages and it seems that a simple auto indentation all over the file could do it for me. How did I add this behaviour for those languages? Just adding this to my <a href="https://github.com/syl20bnr/spacemacs/blob/master/doc/DOCUMENTATION.org#alternative-setup"><code>init.el</code></a>:</p>
<pre><code>(defun indent-some-languages()
  (case major-mode
    ((elixir-mode ruby-mode) (spacemacs/indent-region-or-buffer))))

(defun dotspacemacs/user-config ()
  ...
  (add-hook 'before-save-hook 'indent-some-languages)
  )
</code></pre>
<p>What I am doing there is registering a new hook just before saving the file that will check if I am in Ruby or Elixir mode and in that case call <code>spacemacs/indent-region-or-buffer</code> that will indent the whole file for me.</p>
<p>If you are familiarised with Lisp this snippet will probably look pretty simple to you; but trust me, it took me a while to make it work. This is the reason why I thought it could be interesting to share it.</p>
<p>I would love to know your tricks for Spacemacs, share them with me here or at <a href="https://twitter.com/agonzalezro">@agonzalezro</a>.</p>
]]></content></item><item><title>Key bindings for Spacemacs</title><link>https://agonzalezro.github.io/posts/key_bindings/</link><pubDate>Mon, 02 May 2016 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/key_bindings/</guid><description>I am a happy user of Spacemacs since few months ago. I was (and I still am) a vim user but Spacemacs provide you extremely good defaults and the installation of layers isn&amp;rsquo;t painful at all, things that I sadly can&amp;rsquo;t say about vim.
I ended up with a lot of configuration on my dot files and everytime I wanted to try, for example, a new language, it was difficult to get it working well.</description><content type="html"><![CDATA[<p>I am a happy user of <a href="http://spacemacs.org/">Spacemacs</a> since few months ago. I was (and I still am) a vim user but Spacemacs provide you extremely good defaults and the installation of layers isn&rsquo;t painful at all, things that I sadly can&rsquo;t say about vim.</p>
<p>I ended up with a lot of configuration on <a href="https://github.com/agonzalezro/.dot">my dot files</a> and everytime I wanted to try, for example, a new language, it was difficult to get it working well.</p>
<p>So, now that you know why I did the change let me show you the key bindings that I find useful:</p>
<!-- raw HTML omitted -->
<p>Please, share yours with me! <a href="https://twitter.com/agonzalezro">@agonzalezro</a> or leave a comment :)</p>
<p>PS: if you are starting in development I would start with Atom or some other editor. I moved from vim to Spacemacs because 1) I already knew some vim &amp; 2) it works in terminal, and this is a must for me since I am a heavy user of tmux too.</p>
]]></content></item><item><title>Signing your GitHub work with your Keybase keys</title><link>https://agonzalezro.github.io/posts/keybase/</link><pubDate>Wed, 06 Apr 2016 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/keybase/</guid><description>As you may know, yesterday, GitHub has presented a way to verify your commits on their platform. This is not something new, it&amp;rsquo;s part of the git protocol, but now, they will show a fancy &amp;ldquo;verified&amp;rdquo; label everytime you push a signed commit. Cool? Yeah, pretty cool.
One of the problems I always had since I know GPG is to keep my keys locally. I am pretty sure that some other people take care of their keys as if they were part of their family, but I didn&amp;rsquo;t feel that need yet.</description><content type="html"><![CDATA[<p>As you may know, yesterday, <a href="https://github.com/blog/2144-gpg-signature-verification">GitHub has presented a way to verify your commits</a> on their platform. This is not something new, it&rsquo;s part of the git protocol, but now, they will show a fancy &ldquo;verified&rdquo; label everytime you push a signed commit. Cool? Yeah, pretty cool.</p>
<p>One of the problems I always had since I know GPG is to keep my keys locally. I am pretty sure that some other people take care of their keys as if they were part of their family, but I didn&rsquo;t feel that need yet. <a href="https://keybase.io/">Keybase</a> partially solved this problem for me, let&rsquo;s hope it did it for you as well (ask me for an invite if you don&rsquo;t have one yet).</p>
<p><em>I want to start this article with a disclaimer, I am not a security professional or anything even closer to it; so, if you think I am saying anything stupid, please, do let me know. Also, if you are a heavy user of Keybase, take my steps carefully because I don&rsquo;t know if you account will continue being usable by Keybase (I would expect so, but a disclaimer is always good).</em></p>
<p><strong>What do we need to do then?</strong> Imagine that you are myself and you don&rsquo;t have <code>keybase</code> installed yet, also, you have a Mac:</p>
<pre><code>brew install keybase
</code></pre>
<p>Now go to your Keybase account and download the public and private key, if you don&rsquo;t know how to do it, follow <a href="http://www.keybits.net/2016/02/import-keybase-private-key/">this tutorial by Tom Atkins</a>. Summarising it:</p>
<ol>
<li>Go to your Keybase account.</li>
<li>Click on your key fingerprint and copy/paste that on a file.</li>
<li>Click on &ldquo;edit&rdquo;, then &ldquo;export my private key&rdquo; and copy/paste that as well in a different file.</li>
<li>Now, <code>gpg --allow-secret-key-import --import keybase-private.key</code>.</li>
<li>And, <code>gpg --import keybase-public.key</code>.</li>
</ol>
<p>You are good to go now.</p>
<p>The problem that you will face trying to use your Keybase account is that your email address will look something like <code>username@keybase.io</code> and you can not verify that account on github. For that reasonwe will need to update our key for adding your normal account email and delete the keybase one.</p>
<p>So, let&rsquo;s add your normal account:</p>
<pre tabindex="0"><code># alex @ Alexs-MacBook-Pro in ~/Desktop [18:14:34]
$ gpg --edit-key agonzalezro@keybase.io
...
gpg&gt; adduid
Real name: Alexandre Gonz√°lez Rodr√≠guez
Email address: agonzalezro@gmail.com
Comment:
You are using the `utf-8&#39; character set.
You selected this USER-ID:
    &#34;Alexandre Gonz√°lez Rodr√≠guez &lt;agonzalezro@gmail.com&gt;&#34;

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? o

You need a passphrase to unlock the secret key for
user: &#34;keybase.io/agonzalezro &lt;agonzalezro@keybase.io&gt;&#34;
4096-bit RSA key, ID 68C84A97, created 2014-03-11


pub  4096R/68C84A97  created: 2014-03-11  expires: 2024-03-08  usage: SCEA
                     trust: unknown       validity: unknown
sub  4096R/74F6172C  created: 2014-03-11  expires: 2024-03-08  usage: SEA
[ unknown] (1)  keybase.io/agonzalezro &lt;agonzalezro@keybase.io&gt;
[ unknown] (2). Alexandre Gonz√°lez Rodr√≠guez &lt;agonzalezro@gmail.com&gt;
</code></pre><p><strong>Update: Chris Miller showed me on the comments that this step is not really needed, so don&rsquo;t delete you key, just write <code>q</code> to exit and save the changes.</strong></p>
<p>And delete the <code>keybase.io</code> one:</p>
<pre tabindex="0"><code>...
gpg&gt; 1

pub  4096R/68C84A97  created: 2014-03-11  expires: 2024-03-08  usage: SCEA
                     trust: unknown       validity: unknown
sub  4096R/74F6172C  created: 2014-03-11  expires: 2024-03-08  usage: SEA
[ unknown] (1). Alexandre Gonz√°lez Rodr√≠guez &lt;agonzalezro@gmail.com&gt;
[ unknown] (2)* keybase.io/agonzalezro &lt;agonzalezro@keybase.io&gt;

gpg&gt; deluid
Really remove this user ID? (y/N) y

pub  4096R/68C84A97  created: 2014-03-11  expires: 2024-03-08  usage: SCEA
                     trust: unknown       validity: unknown
sub  4096R/74F6172C  created: 2014-03-11  expires: 2024-03-08  usage: SEA
[ unknown] (1). Alexandre Gonz√°lez Rodr√≠guez &lt;agonzalezro@gmail.com&gt;

gpg&gt; q
Save changes? (y/N) y
</code></pre><p>What we did there on the first line was select the account <code>keybase.io</code>, please, check the number associated with your <code>keybase.io</code> account, don&rsquo;t press <code>1</code> just for the sake of it.</p>
<p>You have everything you need now, so you just need to export your key and <a href="https://github.com/settings/keys">import it on github</a>:</p>
<pre tabindex="0"><code>gpg --armor --export agonzalezro@gmail.com
</code></pre><p>PS: <code>pbcopy</code> is your friend here if you are using Mac :)</p>
<p>The only thing you need to do now is sign a commit, do that with <code>git commit -S</code> and after pushing you will have this beautiful &ldquo;label&rdquo; close to your commit.</p>
<p><a href="https://github.com/agonzalezro/agonzalezro.github.io/commits/polo"><img alt="github verified commit" src="/github_verified_commit.png"></a></p>
<p>I hope that you enjoyed the tutorial, let me know on the comments or on twitter (<a href="https://twitter.com/agonzalezro">@agonzalezro</a>) if something I do is stupid or if you have found it useful!</p>
]]></content></item><item><title>Using Kong with Kubernetes</title><link>https://agonzalezro.github.io/posts/kong-k8s/</link><pubDate>Thu, 17 Dec 2015 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/kong-k8s/</guid><description>This was originally posted on k8s.uk.
If you don&amp;rsquo;t know about Kong yet, you should take a look. It&amp;rsquo;s an Open Source API Gateway, they define themselves as: &amp;ldquo;The open-source management layer for APIs, delivering high performance and reliability.&amp;rdquo; and they are quite right.
I was playing with Kong lately at work (jobandtalent.com, we are hiring!) and I think that it could be pretty awesome as a entry layer to your microservices platform running in Kubernetes.</description><content type="html"><![CDATA[<blockquote>
<p>This was originally posted on <a href="http://k8s.uk/using-kong-with-kubernetes.html">k8s.uk</a>.</p>
</blockquote>
<p>If you don&rsquo;t know about <a href="https://getkong.org">Kong</a> yet, you should take a look. It&rsquo;s an Open Source API Gateway, they define themselves as: &ldquo;The open-source management layer for APIs, delivering high performance and reliability.&rdquo; and they are quite right.</p>
<p>I was playing with Kong lately at work (<a href="http://jobandtalent.com">jobandtalent.com</a>, we are hiring!) and I think that it could be pretty awesome as a entry layer to your microservices platform running in Kubernetes.</p>
<p>For the sake of simplicity I will not run Kong in Kubernetes, but it shouldn&rsquo;t be so difficult since <a href="https://getkong.org/install/">they already provide Docker images</a>. Also, running Kong on the same cluster you will be able to use internal networking between pods: win-win.</p>
<p>So, what will I show?</p>
<ul>
<li>I will deploy a Kubernetes with 2 pods (our 2 microservices) &amp;</li>
<li>I will install Kong locally and configure it to point to this 2 services.</li>
</ul>
<h2 id="go--packing">Go &amp; packing</h2>
<p>I&rsquo;ve created a small Go app that will show the value of an environment variable when you <code>GET /</code>:</p>
<pre><code>package main

import (
  &quot;fmt&quot;
  &quot;log&quot;
  &quot;net/http&quot;
  &quot;os&quot;
)

func main() {
  http.HandleFunc(&quot;/&quot;, func(w http.ResponseWriter, r *http.Request) {
    fmt.Fprintf(w, os.Getenv(&quot;TEST_RESULT&quot;))
  })

  log.Fatal(http.ListenAndServe(&quot;:8080&quot;, nil))
}
</code></pre>
<p>Now we will build the application to later pack it in our image. Remember that if you are in Mac you will need to cross-compile the app to work on Linux:</p>
<pre><code>$ GOOS=linux go build
</code></pre>
<p>We can pack it into our images now. For doing so we need a <code>Dockerfile</code>. It&rsquo;s a simple binary, so the <code>Dockerfile</code> is not complex at all:</p>
<pre><code>FROM scratch
ADD app /
ENTRYPOINT [&quot;/app&quot;]
</code></pre>
<p>Cool! What can we do now with our shiny image? Yes, you are right! Push it to the hub:</p>
<pre><code>$ docker build -t agonzalezro/kong-test .
$ docker push agonzalezro/kong-test
</code></pre>
<h2 id="k8s">k8s</h2>
<p>We have our image on the registry and all we need now is running it on Kubernetes. I am using <a href="https://cloud.google.com/container-engine/">Google Container Engine</a> for deploying this, but you can use whatever you prefer.</p>
<p>Let&rsquo;s create our RCs &amp; services:</p>
<pre><code># rc1.yml
apiVersion: v1
kind: ReplicationController
metadata:
  name: api1
spec:
  selector:
    name: api
    version: first
  template:
    metadata:
      labels:
        name: api
        version: first
    spec:
      containers:
        - name: app
          image: agonzalezro/kong-test
          env:
            - name: TEST_RESULT
              value: &quot;This is the first app&quot;

# rc2.yml
apiVersion: v1
kind: ReplicationController
metadata:
  name: api2
spec:
  selector:
    name: api
    version: second
  template:
    metadata:
      labels:
        name: api
        version: second
    spec:
      containers:
        - name: app
          image: agonzalezro/kong-test
          env:
            - name: TEST_RESULT
              value: &quot;Second!&quot;

# svc1.yml
apiVersion: v1
kind: Service
metadata:
  name: app1-svc
spec:
  type: LoadBalancer
  ports:
    - port: 80
      targetPort: 8080
  selector:
    name: api
    version: first

# svc2.yml
apiVersion: v1
kind: Service
metadata:
  name: app2-svc
spec:
  type: LoadBalancer
  ports:
    - port: 80
      targetPort: 8080
  selector:
    name: api
    version: second
</code></pre>
<p>And now run it:</p>
<pre><code>$ kubectl create -f rc1.yml -f rc2.yml -f svc1.yml -f svc2.yml
</code></pre>
<p>Wait for the service and the pods to be ready and check their IPS:</p>
<pre><code>$ kubectl get services
NAME         CLUSTER_IP      EXTERNAL_IP      PORT(S)   SELECTOR                  AGE
app1-svc     10.159.242.86   130.211.89.175   80/TCP    name=api,version=first    17m
app2-svc     10.159.246.93   104.155.53.175   80/TCP    name=api,version=second   17m
kubernetes   10.159.240.1    &lt;none&gt;           443/TCP   &lt;none&gt;                    1h
</code></pre>
<h2 id="kong">Kong</h2>
<p>Follow the instruction here: <a href="https://getkong.org/install/docker/">https://getkong.org/install/docker/</a> to install Kong locally.</p>
<p>Yeah! We have it up &amp; running so let&rsquo;s point it to our shinny cluster. We need to use Kong API for that (port <code>:8001</code>):</p>
<pre><code>$ http http://dockerhost:8001/apis/ name=first upstream_url=http://130.211.89.175 request_path=/first strip_request_path=true
$ http http://dockerhost:8001/apis/ name=second upstream_url=http://104.155.53.175 request_path=/second strip_request_path=true
</code></pre>
<p>What we did here? We set up two new endpoints <code>/first</code> &amp; <code>/second</code> that are pointing to the both Kubernetes services previously created. We could have done it with DNS as well using <code>request_host</code> instead.</p>
<p>Lets call Kong on the port <code>:8000</code> to use them:</p>
<pre><code>$ http http://dockerhost:8000/first
HTTP/1.1 200 OK
Connection: keep-alive
Content-Length: 21
Content-Type: text/plain; charset=utf-8
Date: Thu, 17 Dec 2015 21:43:41 GMT
Via: kong/0.5.4

This is the first app

$ http http://dockerhost:8000/second
HTTP/1.1 200 OK
Connection: keep-alive
Content-Length: 7
Content-Type: text/plain; charset=utf-8
Date: Thu, 17 Dec 2015 21:43:44 GMT
Via: kong/0.5.4

Second!
</code></pre>
<p>\o/ We did it!</p>
<h2 id="next-steps">Next steps</h2>
<p>You have Kong pointed to your cluster, now it&rsquo;s up to your imagination what to do next. I would say try to configure some rate limiting or auth, it&rsquo;s deadly simply. Check them here: <a href="https://getkong.org/plugins/">https://getkong.org/plugins/</a></p>
<p>If you have any question or you want to discuss this further let me know at <a href="https://twitter.com/agonzalezro">@agonzalezro</a>.</p>
]]></content></item><item><title>Kubernetes volume plugins and Flocker</title><link>https://agonzalezro.github.io/posts/k8s_flocker_plugin/</link><pubDate>Tue, 20 Oct 2015 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/k8s_flocker_plugin/</guid><description>Last month I was working with the guys from Jetstack &amp;amp; ClusterHQ developing a plugina for Kubernetes that will allow the people to easily use Flocker there.
Yesterday I had the pleasure of sharing the stage with Rimas Mocevicius, Kelsey Hightower &amp;amp; Ivan Pedrazas at the Kubernetes London meetup to present the plugin and show the audience that creating volume plugins for Kubernetes is easier than it looks at the first glance.</description><content type="html"><![CDATA[<p>Last month I was working with the guys from <a href="http://www.jetstack.io/">Jetstack</a> &amp; <a href="https://clusterhq.com/">ClusterHQ</a> developing a plugina for Kubernetes that will allow the people to easily use <a href="https://clusterhq.com/flocker/introduction/">Flocker</a> there.</p>
<p>Yesterday I had the pleasure of sharing the stage with <a href="https://twitter.com/Rimusz">Rimas Mocevicius</a>, <a href="https://twitter.com/kelseyhightower">Kelsey Hightower</a> &amp; <a href="https://twitter.com/ipedrazas">Ivan Pedrazas</a> at the <a href="http://www.meetup.com/Kubernetes-London/events/226026848/">Kubernetes London meetup</a> to present the plugin and show the audience that creating volume plugins for Kubernetes is easier than it looks at the first glance.</p>
<p>As an introduction of what you will find:</p>
<ol>
<li>Introduction to Flocker</li>
<li>Introduction to Kubernetes</li>
<li>Introduction to the plugin itself</li>
<li>Code</li>
<li>Summary</li>
</ol>
<p>Here they are:</p>
<!-- raw HTML omitted -->
<p>Also, if you want to take a look to the presenter notes or the original slides, I have them in a GitHub repo: <a href="https://github.com/agonzalezro/slides/tree/master/k8s_flocker_plugin">https://github.com/agonzalezro/slides/tree/master/k8s_flocker_plugin</a></p>
<p>Feel free to contact me if you have any questions! I am <a href="https://twitter.com/agoznalezro">agonzalezro in twitter</a>.</p>
]]></content></item><item><title>How to deploy and update a python app using Kubernetes</title><link>https://agonzalezro.github.io/posts/oct_2015_djugl/</link><pubDate>Fri, 09 Oct 2015 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/oct_2015_djugl/</guid><description>Two days ago I gave a small talk in the DJUGL (Django User Group London) explaining how we could deploy a test application into Kubernetes. This post is going to explain something pretty similar, how to deploy a Flask app into Kubernetes and how to rolling update it.
Before starting, you can find all the materials of this post in my k8s-py-example repo.
Download the app and build it twice, one for each of the version that you want to deploy.</description><content type="html"><![CDATA[<p>Two days ago I gave a small talk in the <a href="https://twitter.com/DJUGL">DJUGL (Django User Group London)</a> explaining how we could deploy a test application into Kubernetes. This post is going to explain something pretty similar, how to deploy a Flask app into Kubernetes and how to rolling update it.</p>
<p>Before starting, you can find all the materials of this post in my <a href="https://github.com/agonzalezro/k8s-py-example">k8s-py-example</a> repo.</p>
<p>Download the app and build it twice, one for each of the version that you want to deploy. This versions will need to be tagged properly and sent to <a href="https://hub.docker.com/">Docker Hub</a>. Basically the steps to follow are:</p>
<pre><code>docker build -t agonzalezro/k8s-py-example .
docker tag agonzalezro/k8s-py-example:latest agonzalezro/k8s-py-example:0.1
# Change the code (src/app.py) a little bit to see the differences
docker build -t agonzalezro/k8s-py-example .
docker tag agonzalezro/k8s-py-example:latest agonzalezro/k8s/py-example:0.2
docker push agonzalezro/k8s-py-example
</code></pre>
<p>Now that all the work related with Docker is done, let&rsquo;s take a look to the needed k8s files:</p>
<p><strong>rc-0.1.yml</strong></p>
<!-- raw HTML omitted -->
<p><strong>rc-0.2.yml</strong></p>
<!-- raw HTML omitted -->
<p><strong>service.yml</strong></p>
<!-- raw HTML omitted -->
<p>The <code>rc</code> files are the definitions of your replication controllers, one of them using the version <code>0.1</code> and the other the image <code>0.2</code>. The service file is share since the application is going to be the same.</p>
<p>Let&rsquo;s run the first version of the app:</p>
<pre><code>kubectl -f rc-0.1.yml -f service.yml --validate=false
# The validate tag is just needed because of a bug in current k8s
</code></pre>
<p>Now, if you do <code>kubectl get services</code> you will see the external IP of your service. You can use it to check that it&rsquo;s running and showing the code of the version <code>0.1</code>.</p>
<p>Cool! You have deployed your first k8s application, now, let&rsquo;s update it:</p>
<pre><code>kubectl rolling-update flaskapp-rc -f rc-0.2.yml
</code></pre>
<p>If you wait a little bit you will see in the logs what&rsquo;s happening there. Let the command finish and you will have your <code>0.2</code> version deployed having causing 0 downtime!</p>
<p>As always, feel free to contact me here or use twitter: <a href="https://twitter.com/agonzalezro">@agonzalezro</a></p>
]]></content></item><item><title>Log your Docker containers from a container with packetbeat</title><link>https://agonzalezro.github.io/posts/packetbeat-docker/</link><pubDate>Mon, 17 Aug 2015 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/packetbeat-docker/</guid><description>packetbeat is one of the best application performance management tools in the opensource community. It&amp;rsquo;s now part of the beats that Elastic provide us to monitor our applications. What it does is analyze our data packets to send some useful information to ElasticSearch.
After the introduction you probably realize that we will need: ElasticSearch installed and if you want to see something useful you will need Kibana as well. There is a guide for getting started that explains the process pretty clearly.</description><content type="html"><![CDATA[<p><a href="https://github.com/elastic/packetbeat">packetbeat</a> is one of the best
application performance management tools in the opensource community. It&rsquo;s now
part of the <a href="https://www.elastic.co/products/beats">beats</a> that Elastic provide
us to monitor our applications. What it does is analyze our data packets to
send some useful information to ElasticSearch.</p>
<p>After the introduction you probably realize that we will need: ElasticSearch
installed and if you want to see something useful you will need Kibana as well.
There is a <a href="https://www.elastic.co/guide/en/beats/packetbeat/current/packetbeat-getting-started.html">guide for getting
started</a>
that explains the process pretty clearly. The &ldquo;problem&rdquo; with that guide is that
you need to install everything in your machine, this blog post is a 101 to have
it quickly running into containers.</p>
<p>As mentioned, we will need ES and Kibana:</p>
<pre><code>docker run -d -p 9200:9200 -p 9300:9300 --name elasticsearch-pb elasticsearch
docker run -d -p 5601:5601 --name kibana-pb --link elasticsearch-pb:elasticsearch \
  -e ELASTICSEARCH_URL=http://elasticsearch:9200 kibana
</code></pre>
<p>Now we have all the required things to run our packetbeat. There are few points
that I want to raise before doing so:</p>
<ol>
<li>packetbeat will be monitoring our network traffic, this means that our
container running packetbeat needs to have access to the host network.</li>
<li>the last <code>Dockerfile</code> I found regarding this was:
<a href="https://github.com/packetbeat/packetbeat-docker">https://github.com/packetbeat/packetbeat-docker</a> by
<a href="https://twitter.com/tudor_g">Tudor</a> (one of the original developers) but
it is a little bit old. So I made my own based on that (should PR but I
wonder why the previous was not updated yet, and it would be nice to run
something more actual than 0.5 but there are no binaries):</li>
</ol>
<!-- raw HTML omitted -->
<p>The previous docker image will require a file <code>packetbeat.yml</code> to work after.
As a quick start you can use this one:
<a href="https://github.com/elastic/packetbeat/blob/master/packetbeat.dev.yml">https://github.com/elastic/packetbeat/blob/master/packetbeat.dev.yml</a> but
probably you would like to change your device from <code>en0</code> to <code>docker0</code>.</p>
<pre><code>docker build -t agonzalezro/packetbeat .
docker run --net=host agonzalezro/packetbeat
</code></pre>
<p>Cool, now you are ready to go! Everything that you do into your containers will
be show on Kibana, to test it go to you docker host port <code>5601</code>, it will ask
for an index pattern, change the default <code>logstash-*</code> to <code>packetbeat-*</code> and
enjoy it!</p>
<p><a href="/packetbeat/kibana.png"><img alt="kibana-screenshot" src="/packetbeat/kibana-thumb.png"></a></p>
<p>If you have any comment, let me know here or in
<a href="http://twitter.com/agonzalezro">twitter</a>. Also, if you are interested in
monitoring with packetbeat you should definitely take a look to <a href="http://acalustra.com/how-can-i-monitor-my-voip-application.html">&ldquo;Kamailio
monitoring with statsd, SIPCapture or
Packetbeat&rdquo;</a>
by my friend <a href="http://twitter.com/eloycoto">eloycoto</a> who introduced me to
packetbeat :a)</p>
]]></content></item><item><title>Go introduction at Shopa</title><link>https://agonzalezro.github.io/posts/go101/</link><pubDate>Wed, 05 Aug 2015 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/go101/</guid><description>Here at Shopa we use Go for some services but we use a lot of Rails as well so not everybody needs to know Go. This is why I&amp;rsquo;ve decided to do a small introduction to it in one of our workshops.
The slides are mainly examples with a little bit of history around the Go world. If you find them useful, feel free to grab them here: https://github.com/agonzalezro/slides/tree/master/go
Probably I&amp;rsquo;ve forgotten about something but it was just a 1 hour and a half presentation.</description><content type="html"><![CDATA[<p>Here at <a href="http://shopa.com">Shopa</a> we use Go for some services but we use a lot
of Rails as well so not everybody needs to know Go. This is why I&rsquo;ve decided to
do a small introduction to it in one of our workshops.</p>
<p>The slides are mainly examples with a little bit of history around the Go
world. If you find them useful, feel free to grab them here:
<a href="https://github.com/agonzalezro/slides/tree/master/go">https://github.com/agonzalezro/slides/tree/master/go</a></p>
<p>Probably I&rsquo;ve forgotten about something but it was just a 1 hour and a half presentation.</p>
<p><a href="http://go-talks.appspot.com/github.com/agonzalezro/slides/go/101.slide">Here you can see them in
action</a>.
I didn&rsquo;t iframed them here because the layout was ugly and the sliding between
slides kinda poor.</p>
<p><a href="http://twitter.com/agonzalezro">Tweet me</a> if you have more comments!</p>
]]></content></item><item><title>Docker workshop at Shopa</title><link>https://agonzalezro.github.io/posts/docker_shopa/</link><pubDate>Wed, 24 Jun 2015 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/docker_shopa/</guid><description>Today I gave a workshop at Shopa about Docker: what is it, why it&amp;rsquo;s useful for us and why it can even be more useful.
I understand that just the slides without any context can be a little bit misleading, but in case that it helps somebody I will share them here:
The design of the PDF looks uglier than it really is, so if you want the html slides you can always use the Dockerfile provided with the source of the slides :)</description><content type="html"><![CDATA[<p>Today I gave a workshop at Shopa about Docker: what is it, why it&rsquo;s useful for
us and why it can even be more useful.</p>
<p>I understand that just the slides without any context can be a little bit
misleading, but in case that it helps somebody I will share them here:</p>
<!-- raw HTML omitted -->
<p>The design of the PDF looks uglier than it really is, so if you want the html
slides you can always use the <a href="https://github.com/agonzalezro/slides/blob/master/docker/Dockerfile"><code>Dockerfile</code> provided with the source of the
slides</a> :)</p>
]]></content></item><item><title>IoT hackathon with Intel Edison and Go</title><link>https://agonzalezro.github.io/posts/edison_hackathon/</link><pubDate>Thu, 18 Jun 2015 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/edison_hackathon/</guid><description>I spent last weekend in a hackathon organised by Intel to show their Intel Edison platform. I can just say that it was awesome, the quality of the projects, the prizes, the food, the freebies (yes, they gave us an Intel Edison)&amp;hellip;
But this post is not about that, I want to explain my project and how I made Golang work in an Intel Edison thanks to gobot.
As you are already aware, Go easily supports cross compiling creating a binary that you can use in your other devices.</description><content type="html"><![CDATA[<p>I spent last weekend in a hackathon organised by Intel to show their Intel
Edison platform. I can just say that it was awesome, the quality of the
projects, the prizes, the food, the freebies (yes, they gave us an Intel
Edison)&hellip;</p>
<p>But this post is not about that, I want to explain my project and how I made
Golang work in an Intel Edison thanks to <a href="http://gobot.io/">gobot</a>.</p>
<p>As you are already aware, Go easily supports cross compiling creating a binary
that you can use in your other devices. In this case, the Intel Edison is (by
default) a Linux distribution with i386 architecture.</p>
<h2 id="what-did-i-do">What did I do?</h2>
<p>I did a simple project to track the happiness of the assistant to a conference:
they can vote if it was a good one ro not &amp; the Edison is also tracking the
clapping. All this information is stored into a
<a href="https://influxdb.com/">InfluxDB</a> and I was using
<a href="http://grafana.org/">Grafana</a> to demo it:</p>
<p><img alt="image" src="/iot_grafana.png"></p>
<p>Ok, let&rsquo;s start!</p>
<h2 id="first-step-setup-the-wifi">First step: setup the wifi</h2>
<p>After you connect the Edison you will have a new decive in <code>/dev/</code> with the
form: <code>/dev/tty.usbserial-...</code>. You can just use screen to connect to it, in my
case:</p>
<pre><code>screen /dev/tty.usbserial-A903BU3J 115200 -L
</code></pre>
<p>Inside the machine:</p>
<pre><code>configure_edison --wifi
</code></pre>
<p>You could as well use <code>--setup</code> if you want to change the name, password, etc&hellip;</p>
<p>Cool! Now we have the device in out network, let&rsquo;s see the IP with <code>ifconfig</code>
and copy/paste it somewhere.</p>
<h2 id="second-step-code">Second step: Code!</h2>
<p>As I said before I was using the gobot framework. This framework easily allows
you to access to the GPIO that I&rsquo;ve been using in the Edison (buttons, lights &amp;
sound sensor).</p>
<p>Here is a snippet:</p>
<pre><code>gbot := gobot.NewGobot()

edisonAdaptor := edison.NewEdisonAdaptor(&quot;edison&quot;)
buttonPositive := gpio.NewButtonDriver(edisonAdaptor, &quot;button_positive&quot;, &quot;4&quot;)

...

robot := gobot.NewRobot(
    &quot;buttonBot&quot;,
    []gobot.Connection{edisonAdaptor},
    []gobot.Device{buttonPositive, buttonNegative, redLed, greenLed, blueLed, soundSensor},
    work,
)
</code></pre>
<p><code>work</code> is a loop where you can heard for the events created by the devices.</p>
<p>If you want to see the full code: <a href="https://github.com/agonzalezro/iotroadshow_june_2015/blob/master/main.go">https://github.com/agonzalezro/iotroadshow_june_2015/blob/master/main.go</a></p>
<h2 id="third-step-compile-deploy--run">Third step: compile, deploy &amp; run</h2>
<p>Crosscompile it. I was using <a href="https://github.com/mitchellh/gox">gox</a> but you
can use the default tools for that as well. In my case:</p>
<pre><code>gox -arch=&quot;386&quot; -os=&quot;linux&quot;
</code></pre>
<p>This will generate a file called <code>project_linux_386</code> that is what you will need
to copy to the Edison.</p>
<p>To copy it you just need a simple scp:</p>
<pre><code>scp project_linux_i386 root@[the_edison_ip]:/home/root/my_program
</code></pre>
<p>And to run it you can ssh and manually run it or as I was doing:</p>
<pre><code>ssh root@[the_edison_ip] /home/root/my_program
</code></pre>
<p>I&rsquo;ve automated this process in a
<a href="https://github.com/agonzalezro/iotroadshow_june_2015/blob/master/Makefile">Makefile</a>.</p>
<p>Also, feel free to check the
<a href="https://github.com/agonzalezro/iotroadshow_june_2015/blob/master/README.md">README.md</a>
with a better explanation about what my project was.</p>
<p>Any question? Reach me on twitter as
<a href="http://twitter.com/agonzalezro">@agonzalezro</a> or just post a comment here.</p>
]]></content></item><item><title>The well deserved Golang UK conference is here</title><link>https://agonzalezro.github.io/posts/golanguk2015/</link><pubDate>Sun, 29 Mar 2015 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/golanguk2015/</guid><description>Hi mum &amp;amp; dad (my 2 followers on the blog?) some friends, (Johanna, Sam &amp;amp; David) and myself have decided to organize a Go conference in the UK the next August 21.
He had opened the blind bird at the beginning of the week and we are already close to finish those cheap tickets, so hurry up and buy a ticket. We can see for the call for papers already received that the quality of the talks is going to be awesome, but don&amp;rsquo;t miss your opportunity as send us a paper before May 31st.</description><content type="html"><![CDATA[<p>Hi mum &amp; dad (my 2 followers on the blog?) some friends,
(<a href="https://twitter.com/johannacherry">Johanna</a>,
<a href="https://twitter.com/_samdb">Sam</a> &amp; <a href="https://twitter.com/_samdb">David</a>) and
myself have decided to organize a Go conference in the UK the next August 21.</p>
<p>He had opened the blind bird at the beginning of the week and we are already
close to finish those cheap tickets, so hurry up and <a href="http://www.eventbrite.co.uk/e/golang-uk-conference-2015-tickets-16233380478">buy a
ticket</a>.
We can see for the call for papers already received that the quality of the
talks is going to be awesome, but don&rsquo;t miss your opportunity as <a href="http://www.golanguk.com/speakers/">send us a
paper</a> before May 31st.</p>
<p>As a final note I want to and that if you want to sponsor the event or you have
any further question, feel free to presonally <a href="https://twitter.com/agonzalezro">contact
me</a> or do it through the conference email:
<a href="http://info@golanguk.com">info@golanguk.com</a>.</p>
<p>I know that a bunch of assiduous people to the meetups is going already, so
hope to see you there as well!</p>
]]></content></item><item><title>Graph your meetup.com group with Neo4J and some Go</title><link>https://agonzalezro.github.io/posts/gotagmee/</link><pubDate>Wed, 25 Feb 2015 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/gotagmee/</guid><description>Last days I&amp;rsquo;ve been spending sometime in a small project for fun. Sadly I couldn&amp;rsquo;t do anything for production so I hacked gotagmee which is a tiny thingy that will created some goroutines to get all the members in a meetup.com group with their interests and store them in a Neo4J DB as Member or Topic entities with their respective relations.
I wrote this because I wanted to get the data, but then I realised that this piece of code is pretty neat (check the github repo for the original):</description><content type="html"><![CDATA[<p>Last days I&rsquo;ve been spending sometime in a small project for fun. Sadly I
couldn&rsquo;t do <a href="https://twitter.com/agonzalezro/status/567823851791589376">anything for
production</a> so I
hacked <a href="https://github.com/agonzalezro/gotagmee">gotagmee</a> which is a tiny
thingy that will created some goroutines to get all the members in a
<a href="http://meetup.com">meetup.com</a> group with their interests and store them in a
Neo4J DB as <code>Member</code> or <code>Topic</code> entities with their respective relations.</p>
<p>I wrote this because I wanted to get the data,  but then I realised that this
piece of code is pretty neat (check the github repo for the original):</p>
<pre tabindex="0"><code>membersChan := make(chan db.Member, 1)
go api.Members(membersChan)

db, _ := db.NewDB(*neo4jDB)

for m := range membersChan {
    db.Store(m)
}
</code></pre><p>Basically I am creating a channel that is going to be used to receive the
members (1 by 1) whenever one of the subroutines scraping the API have one
ready. Perhaps there are better ways to do it, but I really like it :)</p>
<p>Let&rsquo;s go to the important part: <strong>the data</strong>. I&rsquo;ve used the code to extract
the data of the meetup that I co-organize here at London, the <a href="http://www.meetup.com/Go-London-User-Group">Go London User
Group</a> if you are interested, I
could share with you a dump. For this example I was just interested in the
users and topics, but if you want, change it to get more data:
<a href="http://www.meetup.com/meetup_api/docs/2/members/">http://www.meetup.com/meetup_api/docs/2/members/</a></p>
<p>We knew this already, but how many users do we have, easy peasy:</p>
<pre tabindex="0"><code>neo4j-sh (?)$ match (n:Member) return count(n);
+----------+
| count(n) |
+----------+
| 671      |
+----------+
1 row
27 ms
</code></pre><p>But perhaps the number of topic that our users follow is not (was not) as easy
to know:</p>
<pre tabindex="0"><code>neo4j-sh (?)$ match (n:Topic) return count(n);
+----------+
| count(n) |
+----------+
| 1204     |
+----------+
1 row
30 ms
</code></pre><p>I know that I am part of that meeting, what do I &ldquo;like&rdquo;:</p>
<pre tabindex="0"><code>neo4j-sh (?)$ match (n)-[]-(t) where n.name =~ &#34;Alexandre.*&#34; return count(t);
+----------+
| count(t) |
+----------+
| 17       |
+----------+
1 row
255 ms
</code></pre><p>I think that I didn&rsquo;t impress anybody until here, but one of the ideas behind
graph DBs is easily find connections between entities, for example what do I
have in common with my friend <a href="http://twitter.com/ipedrazas">@ipedrazas</a>? I
know that he likes beers as me, but I am talking about meetup.com relations,
let&rsquo;s see!</p>
<pre tabindex="0"><code>neo4j-sh (?)$ match (n)-[]-(t:Topic)-[]-(m) where n.name =~ &#34;Alexandre.*&#34; and m.name =~ &#34;Ivan Pedrazas&#34; return t.name;
+----------------------+
| t.name               |
+----------------------+
| &#34;Open Source&#34;        |
| &#34;Programming&#34;        |
| &#34;Mobile Development&#34; |
| &#34;golang&#34;             |
+----------------------+
4 rows
91 ms
</code></pre><p>Nice! But if you want to do it beautiful for your boss, you could as well use Cypher:</p>
<p><img alt="meetup_neo4j_example" src="/dev/meetup_neo4j_example.png"></p>
<p>Now imagine that I want to target the interest of my group by the things that
they like more, which ones are those?</p>
<pre tabindex="0"><code>neo4j-sh (?)$ match ()-[r]-&gt;(t:Topic) with t, count(r) as rel return t.name order by rel desc limit 10;
+------------------------+
| t.name                 |
+------------------------+
| &#34;Programming&#34;          |
| &#34;Software Development&#34; |
| &#34;Open Source&#34;          |
| &#34;New Technology&#34;       |
| &#34;Technology&#34;           |
| &#34;Web Development&#34;      |
| &#34;Startup Businesses&#34;   |
| &#34;Big Data&#34;             |
| &#34;Cloud Computing&#34;      |
| &#34;Internet Startups&#34;    |
+------------------------+
10 rows
99 ms
</code></pre><p>They were kinda clear for this kind of geeky meetup :)</p>
<p>Hope that you enjoyed, and if you have any more question or queries for the data,
ping me here or at <a href="http://twitter.com/agonzalezro">@agonzalezro</a>.</p>
]]></content></item><item><title>How I prepared my Mac to make some Docker development</title><link>https://agonzalezro.github.io/posts/docker-env/</link><pubDate>Mon, 01 Dec 2014 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/docker-env/</guid><description>This post is about how I did it! not about a standard way or something like that, if you use any other way I would be happy to hear it on the comments.
I usually use boot2docker on my machine to run container, but it looks like it was misbehaving a little bit when I was trying to create the binary of my dev branch with:
$ make binary Actually, it was just not creating it.</description><content type="html"><![CDATA[<p>This post is about <strong>how I did it!</strong> not about a standard way or something like
that, if you use any other way I would be happy to hear it on the comments.</p>
<p>I usually use <code>boot2docker</code> on my machine to run container, but it looks like
it was misbehaving a little bit when I was trying to create the binary of my
dev branch with:</p>
<pre><code>$ make binary
</code></pre>
<p>Actually, it was just not creating it.</p>
<p>I could also create some cross-compiled binaries but that didn&rsquo;t work either.
It was a really weird situation because I couldn&rsquo;t find the path that it was
saying that it was creating. Not in my machine, not in my boot2docker VM
either. So, after some frustrating time I decided to go with vagrant.</p>
<h2 id="what-i-wanted">What I wanted?</h2>
<ul>
<li>My vim! I couldn&rsquo;t live without that.</li>
<li>My ssh keys for github and similar without copying them to the vagrant box.</li>
</ul>
<h2 id="how-i-did-it">How I did it?</h2>
<h3 id="vagrant">vagrant</h3>
<p>It was a simple process after you have clear what you really want to do:</p>
<pre><code>$ cd myawesomebox
$ vagrant init  # Edit the file if you want more memory or similar
$ git clone git@github.com:YOUR_USERNAME/docker
$ vagrant ssh
$ sudo su -
</code></pre>
<p>What we did there? We have created a <code>Vagrantfile</code> and we clone the repo in the
same folder. Thanks to that when we are inside the vagrant box (with <code>vagrant ssh</code>) we will be able to access to it on the path <code>/vagrant</code> of your box.</p>
<p>The advantage of this approach is that you can access to all the docker code
from your host machine in the path <code>myawesomebox</code> so you will not need to copy
any key, any conf or anything like that.</p>
<h3 id="docker">docker</h3>
<p>Now it&rsquo;s time to update your docker server and create your on docker client
(remember that we are logged in as root on that box):</p>
<pre><code># cd /vagrant/docker
# make build&amp;&amp;make binary
# service docker stop
# cp bundles/1.3.2-dev/binary/docker-1.3.2-dev /usr/bin/docker
# service docker start
</code></pre>
<p>Where <code>1.3.2</code> is the  current version at the time of writing &amp;
<code>/usr/bin/docker</code> is your old docker server binary.</p>
<p>Now you are running a new server, but where is the client?! Easy peasy, on the
same place that the server was originally:</p>
<pre><code># bundles/1.3.2-dev/binary/docker
...
</code></pre>
<p>I usually alias it to the letter <code>d</code> to access to it quicker without moving
stuff around:</p>
<pre><code># alias d=&quot;`pwd`/bundles/1.3.2-dev/binary/docker&quot;
</code></pre>
<h2 id="whats-next">What&rsquo;s next?</h2>
<p>I would say that develop some nice pull request? Or at least try! It&rsquo;s fun
anyway :)</p>
<p>I went through all this pain while <a href="http://twitter.com/eloycoto">@eloycoto</a> &amp;
me were developing a <a href="https://github.com/docker/docker/pull/9415">small PR to show vertical <code>ps</code>
outputs</a>, so, thanks mate!</p>
<p>If you have any question or you think that my way of doing this stinks, please,
let me know! I would really, really appreciate it.</p>
]]></content></item><item><title>Dockerizing Pligg with Fig</title><link>https://agonzalezro.github.io/posts/pligg-docker/</link><pubDate>Mon, 24 Nov 2014 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/pligg-docker/</guid><description>For a pet project I needed Pligg which is kinda a social network site in the style of the old-digg (with karma and this kind of things).
Installing a LAMP system is kinda boring stuff, so, for that and for the sake of learning I decided to go with Docker &amp;amp; Fig. Sadly or luckily, every time that I dockerize something I find a lot of unexpected problems that slow me down, but&amp;hellip; you always learn something!</description><content type="html"><![CDATA[<p>For a pet project I needed <a href="http://pligg.com/">Pligg</a> which is kinda a social
network site in the style of the old-digg (with karma and this kind of things).</p>
<p>Installing a LAMP system is kinda boring stuff, so, for that and for the sake
of learning I decided to go with <a href="https://www.docker.com/">Docker</a> &amp;
<a href="http://www.fig.sh/">Fig</a>. Sadly or luckily, every time that I dockerize
something I find a lot of unexpected problems that slow me down, but&hellip; you
always learn something!</p>
<p>This post is to explain a little bit the process and the problems that I found
and how I solved them. It&rsquo;s not a how to, it&rsquo;s more a explanation of what I did
and perhaps you can provide a better solution on the comments.</p>
<h2 id="what-do-i-need">What do I need?</h2>
<p>The site is &ldquo;simple&rdquo; so the only required stuff will be a MySQL server and an
Apache2 server. You could run 2 Docker instances manually, or&hellip; use the magic
provided by Fig. This is the <code>fig.yml</code> file that explains my service:</p>
<pre><code>web:
  build: .
  links:
   - db
  volumes:
   - /var/log:/var/www/logs
  ports:
   - &quot;80:80&quot;
  environment:
   - MYSQL_PASSWORD
   - MY_BASE_URL
db:
  image: mysql
  volumes:
   - /var/lib/mysql:/var/lib/mysql
  environment:
   - MYSQL_DATABASE=dbpligg
   - MYSQL_USER=pligguser
   - MYSQL_ROOT_PASSWORD
   - MYSQL_PASSWORD
  ports:
   - &quot;3306:3306&quot;
</code></pre>
<p>Basically I am saying that I will have 2 servers: &ldquo;web&rdquo; &amp; &ldquo;db&rdquo; and specifying
their volumes, environment variables and exported ports.</p>
<h3 id="problem">Problem?</h3>
<p>First thing that we see here: <code>MY_BASE_URL</code> &amp; <code>MYSQL_{,ROOT_}PASSWORD</code> don&rsquo;t
have any value, this is because Fig is going to got those values from the
current Docker host. I need them for specified some settings file that
originally were written in a normal file (difficult to change while deploying).</p>
<p>Also, <code>MY_BASE_URL</code> is a small/ugly trick. It seems that Pligg requires to know
the host were it&rsquo;s running to serve static assets as CSS or JS.</p>
<p>If you take a look to <a href="https://github.com/agonzalezro/docker-pligg/tree/master/config">my repo <code>config</code>
folder</a> you
will see the slightly modified versions of two configuration files for Pligg
that are making use of this environment variables.</p>
<h3 id="more-problems">More problems?</h3>
<p>For running Pligg we need a minimal DB structure I&rsquo;ve found 2 different ways of
creating this data in my data container, but none of them are optimal for me,
mainly because they require an extra step:</p>
<ul>
<li>
<p>I&rsquo;ve created minimal SQL dump with some default values and on the <code>README.md</code>
provide a quick way of ingest this data using the same container:</p>
<pre><code>  $ docker exec dockerpligg_db_1 \
    mysql -u pligguser -p$MYSQL_PASSWORD dbpligg &lt; &quot;`cat pligg.sql`&quot;
</code></pre>
</li>
<li>
<p>Another way is going through all the installation process accessing to
<a href="http://example.com/install">http://example.com/install</a></p>
</li>
</ul>
<p>I think that perhaps creating a script that checks is the DB if empty and if it
is it uses the SQL to dump the DB back would be an option, but seems kinda
dangerous to automate that process in a live environment (anybody said delete
data by a mistaken dump?).</p>
<p><a href="http://acalustra.com/">@eloycoto</a> has recommended me to use inheritance of
containers. But I am not happy with that solution either: I would need two
<code>Dockerfile</code>s and possibly two <code>fig.yml</code> files as well or add some weird magic
to replace one container with the other after the installation.</p>
<h3 id="third-thing-that-i-dont-really-like">Third thing that I don&rsquo;t really like</h3>
<p>After the first time that you run the installation you need to manually remove
the install path (this seems quite common in PHP apps?). I am doing that
running a <code>docker exec</code> to that container, but I would prefer to manually
remove it with the <code>Dockerfile</code>. Why I don&rsquo;t do so? Because if I remove that
folder I am forcing all the users of my configuration to use the dump SQL
method explained above and I don&rsquo;t give them any change.</p>
<h2 id="so">So&hellip;</h2>
<p>I suspect that it&rsquo;s normal to have that kind of problems trying to &ldquo;migrate&rdquo; an
application that was never used before in a Docker container.</p>
<p>To be honest with Pligg, the only changes that I required were minimal, but I
don&rsquo;t know if that &ldquo;install&rdquo; part could be just removed with my own settings
file, I tried that and it was asking me to repeat values that were already set
in the <code>settings.php</code>.</p>
<p>I am not happy with the dump/install solution that I&rsquo;ve found, but it works‚Ñ¢!</p>
<p>I am sure that if you were using Docker or Fig before you will have plenty of
complaints about my article, let me know leaving a comment or just <a href="http://twitter.com/agonzalezro">tweet me
something</a>.</p>
]]></content></item><item><title>How to manage multiple errors in Go</title><link>https://agonzalezro.github.io/posts/errors/</link><pubDate>Fri, 17 Oct 2014 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/errors/</guid><description>Let me start with a disclaimer, I don&amp;rsquo;t really know if this is a pattern that must be followed or it&amp;rsquo;s just a weird idea coming out of my head.
The second disclaimer is that I am pretty sure that I am not the only mind that thought about this, but I didn&amp;rsquo;t see it in use in any place. Why?
Error handling in Go has his advantages and disadvantages, for me, the most important disadvantage is the &amp;ldquo;weird&amp;rdquo; way of checking the error just after the line that can raise it.</description><content type="html"><![CDATA[<p>Let me start with a disclaimer, I don&rsquo;t really know if this is a pattern that
must be followed or it&rsquo;s just a weird idea coming out of my head.</p>
<p>The second disclaimer is that I am pretty sure that I am not the only mind that
thought about this, but I didn&rsquo;t see it in use in any place. Why?</p>
<p>Error handling in Go has his advantages and disadvantages, for me, the most
important disadvantage is the &ldquo;weird&rdquo; way of checking the error just after the
line that can raise it.</p>
<p>I&rsquo;ve experimenting a little bit with it and I found this solution:</p>
<!-- raw HTML omitted -->
<p>Basically, with the default approach you would need 2 new lines as follows:</p>
<pre tabindex="0"><code>if err != nil {
   ...
}
</code></pre><p>I find this pattern pretty useful for things like http handlers or so.</p>
<p>Also, you are able to add a <code>switch</code> at the end to check the kind of error and
keep your code more &ldquo;organized&rdquo;.</p>
<p>What do you think? Should I use it in every place I can? Do you do it in a
better way?</p>
]]></content></item><item><title>Draw (and more) your architecture with Neo4J</title><link>https://agonzalezro.github.io/posts/neo4j_architecture/</link><pubDate>Tue, 26 Aug 2014 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/neo4j_architecture/</guid><description>As some of you already know I work at Green Man Gaming (mainly at the playfire project). We were planning to do some changes in our architecture but it&amp;rsquo;s extremely hard to have an idea of all our services and DBs in just a piece of A4 paper. I was trying, trust me, but it was impossible.
When I started with this task I did it with lucidchart, after it got so messy I moved to graphviz, but even with the usual good graphs that I get from graphviz it was impossible to get something readable this time.</description><content type="html"><![CDATA[<p>As some of you already know I work at <a href="http://greenmangaming.com">Green Man
Gaming</a> (mainly at the
<a href="http://playfire.com">playfire</a> project). We were planning to do some changes
in our architecture but it&rsquo;s extremely hard to have an idea of all our services
and DBs in just a piece of A4 paper. I was trying, trust me, but it was
impossible.</p>
<p>When I started with this task I did it with
<a href="https://www.lucidchart.com">lucidchart</a>, after it got so messy I moved to
<a href="http://www.graphviz.org/">graphviz</a>, but even with the usual good graphs that
I get from graphviz it was impossible to get something readable this time.</p>
<p>So, it happened! I remembered <a href="http://ivan.pedrazas.me/?p=280">this post</a> made
by my friend Iv√°n and I thought, why not?</p>
<p>Sadly, this post is not going to show any real data from GMG, but if you are
interested it&rsquo;s the moment to apply because we are hiring &amp; we have the graphs
around all the whiteboard in the office! Just grab me an email.</p>
<h2 id="what-do-i-need">What do I need?</h2>
<p>Basically, you just need Neo4J. You can install it however you want, I&rsquo;ve just
run a Docker container with it:</p>
<pre><code>docker run -d -p 7474:7474 tpires/neo4j
</code></pre>
<p>Now, if you access to your docker container at http://localhost:7474 (or using
the host from <code>boot2docker ip</code> if you run docker with boot2docker) you will see
the cypher shell which is one of the ways that you can use to interact with
your DB.</p>
<h2 id="what-i-am-going-to-draw">What I am going to draw?</h2>
<p>In my case, and for a POC, I&rsquo;ve written the following entities:</p>
<ul>
<li>Person</li>
<li>Technology</li>
<li>Service</li>
</ul>
<p>You could write some other entities as for example DBs.</p>
<p>The connections here are kinda clear: a person knows a technology which is
used to write a service that use a DB as backend, so, let&rsquo;s write it!</p>
<p>To create entities the syntax is as follow:</p>
<pre><code>CREATE (variable:Type{attributes})
</code></pre>
<p>And to create Relations (one of the ways):</p>
<pre><code>CREATE (variable1)-[:RELATION_NAME]-&gt;(variable2)
</code></pre>
<p>You will understand this better after we start creating our entities.</p>
<p>Create your engineers:</p>
<pre><code>CREATE
  (dev1:Person{name:&quot;Alex&quot;}),
  (dev2:Person{name:&quot;Maria&quot;}),
  (dev3:Person{name:&quot;Pepe&quot;}),
</code></pre>
<p>Before the : you can see that we have defined a variable to refer to this
just-created entities. All the nodes that we are creating here are of type
Person and each of them have a different name.</p>
<p>To create the relationships between Technology and Person, we define the
technology using the same method that we used to create the Person, but we add
the relationships:</p>
<pre><code>...
  (python:Technology{name:&quot;Python&quot;}),
  (go:Technology{name:&quot;Go&quot;}),

  (dev1)-[:KNOWS]-&gt;(python),
  (dev1)-[:KNOWS]-&gt;(go),
  (dev2)-[:KNOWS]-&gt;(python),
  (dev3)-[:KNOWS]-&gt;(go),
</code></pre>
<p>And finally, we add our services:</p>
<pre><code>...
  (service1:Service{name:&quot;Service #1&quot;}),
  (service2:Service{name:&quot;Service #2&quot;}),

  (service1)-[:CONNECTS]-&gt;(service2),
  (service1)-[:WRITTEN_WITH]-&gt;(go),
  (service2)-[:WRITTEN_WITH]-&gt;(python)
</code></pre>
<h2 id="querying-for-drawing">Querying for drawing</h2>
<p>Now, you can run all the script and we can see the result. For the first output
we are going just to show everything:</p>
<pre><code>MATCH (n)-[r]-() RETURN n, r
</code></pre>
<p>And you will get this!</p>
<p><img alt="Cypher MATCH #1" src="/biz/neo4j_architecture/1.png"></p>
<p>So, what&rsquo;s the point of all this? Basically, that you can do queries that will
make the graph smaller for your needs. This example data that we have added is
quite small (just few nodes), in the real graph that I am working on we have
already few dozens. For example, imagine that you just want to see python
related information:</p>
<pre><code>MATCH (a)-[r]-() WHERE a.name=&quot;Python&quot; RETURN a, r
</code></pre>
<p><img alt="Cypher MATCH #2" src="/biz/neo4j_architecture/2.png"></p>
<p>Or you just want to see the people that can work with the Server #1</p>
<pre><code>MATCH (s:Service)-[r]-()-[r2:KNOWS]-(p:Person)
WHERE s.name=&quot;Service #1&quot; RETURN s, p
</code></pre>
<p><img alt="Cypher MATCH #2" src="/biz/neo4j_architecture/3.png"></p>
<h2 id="one-more-thing">One more thing</h2>
<p>For now, this project in my company is just a POC and I have not really clear
what attributes and entities I should draw to make this graph useful for the
present and for the future. If you have previous experiences or you want to
start a brainstorming, write on the comments or <a href="http://twitter.com/agonzalezro">find me at
twitter</a>.</p>
<p>Also, for now I am happy with just creating some screenshots from the data that
Cypher is showing to me, but it would be really nice to find a more
professional way of sharing this graphs. Cypher renders them with D3, so, I
don&rsquo;t fully understand why it doesn&rsquo;t support exporting them in a easy way.
Again, if you know something, just let me know.</p>
]]></content></item><item><title>How to find a flat in London with some help</title><link>https://agonzalezro.github.io/posts/flats/</link><pubDate>Sun, 03 Aug 2014 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/flats/</guid><description>EDIT: I&amp;rsquo;ve added a little bit more of code to the gist to get the latitude and longitude of the flat. This way the process of plotting them is more accurate and incredibly easy. Thanks again CartoDB!
At the end of this month I am going to move with a friend. This movement is going to be something like the 7th one since I am living here (little bit less than 2 years).</description><content type="html"><![CDATA[<p><strong>EDIT:</strong> I&rsquo;ve added a little bit more of code to the gist to get the latitude
and longitude of the flat. This way the process of plotting them is more
accurate and incredibly easy. Thanks again <a href="http://cartodb.com">CartoDB</a>!</p>
<p>At the end of this month I am going to move with a friend. This movement is
going to be something like the 7th one since I am living here (little bit less
than 2 years).</p>
<p>We are a little bit struggling trying to find a place so I decided that we need
a little bit of help:</p>
<p>Do you know <a href="http://gumtree.com">gumtree.com</a>? That page is extremely good for
renting if you just take care of the content (aka adverts that users upload)
but it&rsquo;s extremely bad at searching: I couldn&rsquo;t filter to know when the flat would be available and I would be able to move in! Seriously?</p>
<p>To fix this I made a small scraper that is going to gather data from few pages
of the search results already filtered by gumtree, check the <code>QUERY_PARAMS</code> on
the <a href="https://gist.github.com/agonzalezro/440e7bf41e77c284d735">following gist</a>:</p>
<!-- raw HTML omitted -->
<p>In the other hand, the location needs to be a place close to King&rsquo;s Cross and
close to Mile End. Calculate commute times from one address to another one
doesn&rsquo;t look straightforward and easy to do, so, the best solution (in relation
dev_time/benefit) was showing all those flats in a map, and I made it thanks to
the help of CartoDB. This piece of software is amazing, basically the process
was:</p>
<ol>
<li>drag&amp;drop the CSV to your CartoDB account.</li>
<li><del>click on the dropdown of the &ldquo;location&rdquo; row and then on &ldquo;Georeference&rdquo;.</del></li>
<li><del>in the popup that will be shown to you, you must select &ldquo;&ldquo;You have one or
more columns with the address&rdquo;, and after that you will have a georeferenced
list of points. The only bad point with this solution is that every month
you just have 100 geoferential queries available for free :(</del></li>
</ol>
<p>With that data you can create your own visualisation as I made here:</p>
<!-- raw HTML omitted -->
<p>If you want to say something about this post or you want to offer me a nice
flat in London, feel free of use the comments or find me in twitter:
<a href="http://twitter.com/agonzalezro">@agonzalezro</a></p>
]]></content></item><item><title>12 Go Best Practices</title><link>https://agonzalezro.github.io/posts/go_meetup_mar_2014/</link><pubDate>Wed, 02 Apr 2014 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/go_meetup_mar_2014/</guid><description>Last Monday I had the chance to see @francesc talking on the Go London User Group. His talk was about best practices (and advices) when you are programming in Go.
Summarising it a little bit, I would say that some of the cases explained there are things that you are going to finish doing even without knowing that you are doing &amp;ldquo;best practices&amp;rdquo;, but they are other examples that are incredible useful and clever &amp;amp; I would love to assist to this conference few months ago.</description><content type="html"><![CDATA[<p>Last Monday I had the chance to see <a href="https://twitter.com/francesc">@francesc</a>
talking on the <a href="http://www.meetup.com/Go-London-User-Group">Go London User
Group</a>. His talk was about best
practices (and advices) when you are programming in Go.</p>
<p>Summarising it a little bit, I would say that some of the cases explained there
are things that you are going to finish doing even without knowing that you are
doing &ldquo;best practices&rdquo;, but they are other examples that are incredible useful
and clever &amp; I would love to assist to this conference few months ago.</p>
<p>At the beginning of the slides you are going to see an step-by-step refactoring
which could (and should) be applied to any other language out there. You will
realise of the major improvement on the readability of that piece of code.
Francesc said that the refactored version could possibly be a little bit
slower, but you will have in your power a piece of maintainable code.</p>
<p>If I need to choose one of the tricks showed, I would definitely go for the
type switch on the (<a href="http://talks.golang.org/2013/bestpractices.slide#8">slide
#8</a>). Basically, you can
receive an interface as parameter and do a quick casting to whatever kind of
type that you want:</p>
<pre><code>....
switch x := v.(type) {  // where v is an interface{}
case string:
    w.Write(int32(len(x)))
    w.Write([]byte(x))
...
</code></pre>
<p>I would say too that coming from a language like Python, it&rsquo;s really easy to be
temped to overuse that functionality :) What do you think?</p>
<p>Finally, <a href="http://talks.golang.org/2013/bestpractices.slide#1">here you have the
slides</a> enjoy them as I
did!</p>
]]></content></item><item><title>Tailing multiple logs with tmux</title><link>https://agonzalezro.github.io/posts/tailing-with-tmux/</link><pubDate>Sat, 15 Mar 2014 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/tailing-with-tmux/</guid><description>I had a system that was creating a different log for each worker. Those logs where in the form: /var/log/baselog, /var/log/baselog.1, /var/log/baselog.2 and so on. I wanted to tail them but they were being updated simultaneously so the output of the tail was being a mess.
I am a tmux user since few months ago (if you aren&amp;rsquo;t, you should!) so I&amp;rsquo;ve decide to open all of them in different tmux panes.</description><content type="html"><![CDATA[<p>I had a system that was creating a different log for each worker. Those logs
where in the form: <code>/var/log/baselog</code>, <code>/var/log/baselog.1</code>,
<code>/var/log/baselog.2</code> and so on. I wanted to tail them but they were being
updated simultaneously so the output of the tail was being a mess.</p>
<p>I am a <a href="http://tmux.sourceforge.net/">tmux</a> user since few months ago (if you
aren&rsquo;t, you should!) so I&rsquo;ve decide to open all of them in different tmux
panes. Thanks to having a pane for every log what we will achieve is the
ability to scroll just one of them, maximize it in case that we need it, move
to a new window, save the buffer&hellip;</p>
<p>How can you achieve that? Quite simple, just download this script to some
place:</p>
<!-- raw HTML omitted -->
<p>Once you have saved it installed, run it with the base log file:</p>
<pre><code>sh tail_several_logs.sh /var/log/baselog
</code></pre>
<p>The script have some limitations easily fixable:</p>
<ul>
<li>You should provide a fullpath.</li>
<li>The logs should be in the form of baselog.N where N is a number.</li>
<li>I am pretty sure that the loop can be done better.</li>
<li>And select the layout in every iteration is not the best of the ideas, but it
works.</li>
</ul>
<p>Feel free of do whatever you want with the script. I just hope that it&rsquo;s useful
for somebody else.</p>
]]></content></item><item><title>Python and Scala smoke the peace pipe</title><link>https://agonzalezro.github.io/posts/pygrunn_2013/</link><pubDate>Mon, 13 May 2013 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/pygrunn_2013/</guid><description>This was my talk on the PyGrunn conference last Friday.
I was explaining how can you communicate services written in different languages using Apache Thrift for that.
In few days the videos will be available, but TBH, I don&amp;rsquo;t really know if I will publish it here. It was not the first time that I talk in public using English, but it will be the first time that it is recorded&amp;hellip; I don&amp;rsquo;t really know if I want to see that!</description><content type="html"><![CDATA[<p>This was my talk on the <a href="http://pygrunn.nl">PyGrunn</a> conference last
Friday.</p>
<p>I was explaining how can you communicate services written in different
languages using <a href="http://thrift.apache.org/">Apache Thrift</a> for that.</p>
<p>In few days the videos will be available, but TBH, I don&rsquo;t really know
if I will publish it here. It was not the first time that I talk in
public using English, but it will be the first time that it is
recorded&hellip; I don&rsquo;t really know if I want to see that! :D</p>
<p>I really need to improve my speed talking for the next time. I thought
that I will not have enough time to explain all, so, my subconscious
decided that I should be talking as a machine gun.</p>
<p>Below, you will find the slides, if not, <a href="https://speakerdeck.com/agonzalezro/python-and-scala-smoke-the-peace-pipe">try this
link</a>.</p>
<!-- raw HTML omitted -->
<p>PS: you can find the source code of the slides here
<a href="https://github.com/agonzalezro/slides/tree/master/thrift">[1]</a> &amp; the
source code of the demo here
<a href="https://github.com/agonzalezro/thriftest">[2]</a>.</p>
<p>Enjoy them!</p>
]]></content></item><item><title>Here I go PyGrunn'13!</title><link>https://agonzalezro.github.io/posts/pre_pygrunn_2013/</link><pubDate>Wed, 17 Apr 2013 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/pre_pygrunn_2013/</guid><description>I am really proud of say that the next month I will be giving a talk at PyGrunn!
This is a really good new for me because PyGrunn is the conference that my old colleagues organize since years ago. I was on it first time in 2011 just one week after I started working at Paylogic. I meet a lot of interesting people there and I will see them again this year!</description><content type="html"><![CDATA[<p>I am really proud of say that the next month I will be giving a talk at
PyGrunn!</p>
<p>This is a really good new for me because PyGrunn is the conference that
my old colleagues organize since years ago. I was on it first time in
2011 just one week after I started working at
<a href="http://paylogic.com">Paylogic</a>. I meet a lot of interesting people
there and I will see them again this year!</p>
<p>In 2012 I repeat, but at that time I had already started to organize the
&ldquo;Monthly PyGrunn&quot;s with <a href="http://twitter.com/_ivor">Ivor</a>. TBH that talks
were quite successful, and not for the quantity of people that we get
there, if not for the quality of them and the networking after!</p>
<p>I am really happy too because going there I will be able to see a lot of
friends that I miss! I just moved here 5 months ago but I really want to
see them!</p>
<p>Now, the less important thing: about the talk! I will be talking about
Thrift and how can we use it to talk between different applications in
different languages (in the examples: Python &amp; Scala). When PyGrunn
finish I think that I will have a video where you can see the talk (or
check my English) and I will upload the slides too!</p>
<p>Thanks to <a href="http://www.pygrunn.org">PyGrunn</a> for give me this chance!</p>
]]></content></item><item><title>codereview from the POV of a noob</title><link>https://agonzalezro.github.io/posts/codereview/</link><pubDate>Tue, 29 Jan 2013 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/codereview/</guid><description>Hi g(irl|uy)s! I would like to start with a disclaimer:
I am not (and I don&amp;rsquo;t pretend to be) a craftmanship trooper (they like to be called like that isn&amp;rsquo;t?), senior engineer with more years of experience that the technology has, guru, blablabla&amp;hellip;
I just want to show my opinion about this process (which I really like!). But more important that share my opinion, is to know what is yours, so, please, comment!</description><content type="html"><![CDATA[<p>Hi g(irl|uy)s! I would like to start with a disclaimer:</p>
<p><em>I am not (and I don&rsquo;t pretend to be) a craftmanship trooper (they like
to be called like that isn&rsquo;t?), senior engineer with more years of
experience that the technology has, guru, blablabla&hellip;</em></p>
<p><em>I just want to show my opinion about this process (which I really
like!). But more important that share my opinion, is to know what is
yours, so, please, comment!</em></p>
<p>Today we had an interesting conversation at work about how we make and
how we should make our codereviews. My point of view is that there are
three different things to check:</p>
<ol>
<li><strong>Code syntax.</strong> It&rsquo;s a part that should be 100% automagically done.
I usually work with python and I let this work to
<a href="http://pypi.python.org/pypi/flake8">Flake8</a> on vim, but it&rsquo;s always
good to have a git hook.</li>
<li><strong>Reusability and maintainability.</strong> I am afraid that this is the
worst part to check, it&rsquo;s a manual process and it is really
subjective. Some people can think that use itertools with 2 lambda
functions is pretty clear and comprehensible, other people can think
that this code is the result of a dirty mind developer.</li>
<li><strong>Functionality.</strong> Automated test! All the test that you can, and of
course, they worst the time that you will spent developing them.
There are things that can not be easily tested but in that case
let&rsquo;s suppose that you were clever enough to test them manually and
in the case that is possible you can show it to anybody else (this
really helps!).</li>
</ol>
<p>As I said the point 1 can be (and should be) automated! It&rsquo;s really easy
to do, the same way that <a href="http://pypi.python.org/pypi/flake8">Flake8</a>
exists for python, I am pretty sure that you will have one for your
favourite language. It&rsquo;s really painful get back a pull request just for
some spaces that are not in place.</p>
<p>For the point 3, yep, let me jump the second for now. Unit testing,
integration testing, functional testing&hellip; whatever you want, but try to
automate it. This + a CI server will make your live really &ldquo;easy&rdquo;!</p>
<p>And finally, about the second point. Each developer have their way to do
the things, but usually there are some points that can be fixed and
sometimes because we don&rsquo;t know, other times just because we are lazy
but we post code like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">f</span>(a, b, c):
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> (a <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">1</span> <span style="color:#f92672">and</span>
</span></span><span style="display:flex;"><span>        request<span style="color:#f92672">.</span>user <span style="color:#f92672">and</span>
</span></span><span style="display:flex;"><span>        request<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>is_authenticated() <span style="color:#f92672">and</span> request<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>has_perm(<span style="color:#e6db74">&#39;write&#39;</span>)
</span></span><span style="display:flex;"><span>    ):
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> HttpResponse(json<span style="color:#f92672">.</span>dumps(<span style="color:#e6db74">&#39;{authorized: True, &#39;</span>a<span style="color:#e6db74">&#39;: a}))</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">if</span> a <span style="color:#f92672">&gt;=</span> <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> HttpResponse(json<span style="color:#f92672">.</span>dumps(<span style="color:#e6db74">&#39;{authorized: True, &#39;</span>a<span style="color:#e6db74">&#39;: a}))</span>
</span></span></code></pre></div><p>This is just an example, but you should agree with me that it&rsquo;s really
easy to improve. This is what, in my opinion should be more checked in
the reviews.</p>
<p>This was just an example (please, remember that :D), but could be
improved with something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">proper_function_name</span>(proper_variable_name):
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;&#34;&#34;This is an amazing function that will do just a thing.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :param proper_variable_name: what I am?
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    :returns: An HttpResponse object with the following JSON content:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        {&#39;authorized&#39;: bool,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">         &#39;proper_variable_name: int}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    &#34;&#34;&#34;</span>
</span></span><span style="display:flex;"><span>    is_authorized <span style="color:#f92672">=</span> (
</span></span><span style="display:flex;"><span>        request<span style="color:#f92672">.</span>user <span style="color:#f92672">and</span>
</span></span><span style="display:flex;"><span>        request<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>is_authenticated() <span style="color:#f92672">and</span>
</span></span><span style="display:flex;"><span>        request<span style="color:#f92672">.</span>user<span style="color:#f92672">.</span>has_perm(<span style="color:#e6db74">&#39;write-resource&#39;</span>)
</span></span><span style="display:flex;"><span>    )
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> HttpResponse(
</span></span><span style="display:flex;"><span>        json<span style="color:#f92672">.</span>dumps({
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;authorized&#39;</span>: is_authorized,
</span></span><span style="display:flex;"><span>            <span style="color:#e6db74">&#39;proper_variable_name&#39;</span>: proper_variable_name
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>    )
</span></span></code></pre></div><p>Those were the improvements (again, remember that it&rsquo;s just an example):</p>
<ol>
<li>Give a proper name to the function. Don&rsquo;t be afraid, everybody has
autocompletion! :D</li>
<li>Give a proper name to the vars.</li>
<li>DOCUMENT! In this example, ready for Sphinx.</li>
<li>Simplify the if statements, actually, after take a look you made it
dissapear.</li>
<li>One return.</li>
</ol>
<p>So, what&rsquo;s your opinion? What do you think that is more important in a
codereview.</p>
]]></content></item><item><title>Best vim colors ever!</title><link>https://agonzalezro.github.io/posts/colors/</link><pubDate>Wed, 23 Jan 2013 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/colors/</guid><description>Sometimes a developer needs a change, and what can you change better that the color scheme that you use to develop? You are more than 8h per day in front of your vim with some beautiful, or crappy, code in front of you. In the first case the colors doesn&amp;rsquo;t matter, but in the second it&amp;rsquo;s really important to enjoy, at least, the colors!
The colors scheme that you use is something really personal, but it always help when somebody checked them and show them to you without the embarrasment of doing it yourself, and this is what I will do, because I was looking, but out of the amazing vimcolorschemetest project nobody seems to give importance to this.</description><content type="html"><![CDATA[<p>Sometimes a developer needs a change, and what can you change better
that the color scheme that you use to develop? You are more than 8h per
day in front of your vim with some beautiful, or crappy, code in front
of you. In the first case the colors doesn&rsquo;t matter, but in the second
it&rsquo;s really important to enjoy, at least, the colors!</p>
<p>The colors scheme that you use is something really personal, but it
always help when somebody checked them and show them to you without the
embarrasment of doing it yourself, and this is what I will do, because I
was looking, but out of the amazing vimcolorschemetest project nobody
seems to give importance to this. This project is really good, but it
just show to you a bunch of colors without any order of preference, I
will fix that for you!</p>
<p>Below is the list of the colors that I&rsquo;ve tried that need some mention
here. The order is just alfabetically, not my preferences.</p>
<h2 id="my-choices">My choices</h2>
<h3 id="bensday">bensday</h3>
<p><img alt="image" src="/vim/bensday.png"></p>
<h3 id="clarity">clarity</h3>
<p><img alt="image" src="/vim/clarity.png"></p>
<h3 id="desertex">desertEx</h3>
<p>It&rsquo;s really similar to deser, which comes by default</p>
<p><img alt="image" src="/vim/desertEx.png"></p>
<h3 id="jelleybeans">jelleybeans</h3>
<p>My favourite for now, but make me chnage my opinion</p>
<p><img alt="image" src="/vim/jelleybeans.png"></p>
<h3 id="winsterday">winsterday</h3>
<p><img alt="image" src="/vim/winsterday.png"></p>
<p>I am currently using <em>jelleybeans</em> (after a recommendation of my
colleague Robin), I really like it, but a little bit &ldquo;happier&rdquo; colors
would not be bad either :)</p>
<h2 id="find-them">Find them!</h2>
<p>You can find all this colors and a lot more here:
<a href="https://github.com/flazz/vim-colorschemes">https://github.com/flazz/vim-colorschemes</a></p>
<p>Please, I am open to all the suggestion that you want, since the new
amazing color scheme for vim that I don&rsquo;t know yet, until the killer
plugin that I can not miss! And of course, if you want to codereview the
code that you see on the screenshots feel free too!</p>
]]></content></item><item><title>PyGrunn Winter Hackathon 2012</title><link>https://agonzalezro.github.io/posts/winter-hackathon-2012/</link><pubDate>Tue, 27 Nov 2012 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/winter-hackathon-2012/</guid><description>Few days ago, actually, more than one week ago (but I was very busy :) we made our first PyGrunn hackathon. I was lucky and from all the list of ideas, the selected was one of mines! The slides generator, that finally we call hovercraft. Here is a small introduction about what I wanted:
A small platform to create slides and have them always associated to a web with this possibilities:</description><content type="html"><![CDATA[<p>Few days ago, actually, more than one week ago (but I was very busy :)
we made our first <a href="http://paylogic.github.com/winter-hackathon/">PyGrunn
hackathon</a>. I was lucky
and from all the list of ideas, the selected was one of mines! The
slides generator, that finally we call <strong>hovercraft</strong>. Here is a small
introduction about what I wanted:</p>
<p><em>A small platform to create slides and have them always associated to a
web with this possibilities:</em></p>
<ul>
<li><em>Create an account with Google (or perhaps twitter, facebook&hellip;), but Google seems the best option for me now.</em></li>
<li><em>Create or edit new slides related with this account. This slides creator/editor will have the following functionalities:</em>
<ul>
<li><em>Select one image for background in fullscreen.</em></li>
<li><em>Write one or 2 lines of text that will always fulfill the width of the slide.</em></li>
<li><em>Change the font family.</em></li>
</ul>
</li>
<li><em>Have a permanent link to your slide (completely public for now).</em></li>
</ul>
<p>After the hackathon we got something very similar to what I wanted, with
some small issues. But this post is not about what we did wrong! This
post is about which technologies did we use to finish the project and
perhaps, if I am lucky, start a discussion on why we did/didn&rsquo;t make a
good choice.</p>
<h2 id="how-do-we-achieve-this">How do we achieve this?</h2>
<h3 id="backend">Backend</h3>
<p>The backend of the application was almost inexistent, we only wanted to
allow the users to login with a Google account to have access to edit
their slides. Being a hackathon we didn&rsquo;t spend time adding CRUD
(Create/Read/Update/Delete) functionalities to manage the users.</p>
<p>If you want to delete your user, let me know, I will do it by hand :) It
was made with <a href="http://flask.pocoo.org/">Flask</a>, Flask-OAuth for the
authentication with Google and <a href="http://redis.io/">redis</a> to store the
presentations.</p>
<h3 id="frontend">Frontend</h3>
<p>The viewer was really simply too because from the beginning we wanted to
play with the editor (it was more funny). For doing it we used
<a href="http://lab.hakim.se/reveal-js/#/">revealjs</a> to show the presentation
with slide effect and <a href="http://fittextjs.com/">jquery-fittext</a> to make it
fullslide.</p>
<p>Now the important part! We made the editor with <a href="http://agonzalezro.github.com/backbonejs-underscore-small-intro.html">backbone and
underscore</a>,
it seems to us the better choice, since we will have 3 principal views:</p>
<dl>
<dt>The background chooser</dt>
<dd>which is connection to <a href="http://www.deviantart.com/">deviantart</a> to
perform a query of good backgrounds for your slide. Then you can
click on one of the results and will be applied to the current
slide.</dd>
<dt>The font chooser</dt>
<dd>which is loading some google fonts, we wanted to do this
automagically but we couldn&rsquo;t finish it at time. The behaviour is
the same, you choose a font and its applied to the current slide.</dd>
<dt>The slide content</dt>
<dd>that should be WYSIWYG (What You See Is What You Get) but for now is
on the middle, because we couldn&rsquo;t make the text bigger while you
are writing.</dd>
</dl>
<h3 id="deployment">Deployment</h3>
<p>And finally the deployment that was made with heroku and redistogo that
allows you to use a 5M non-persistant DB that is good for a demo.</p>
<h2 id="resources">Resources</h2>
<ul>
<li>You can see the list of all the projects or&hellip;</li>
<li>You can find all the <a href="https://github.com/agonzalezro/hovercraft">source on
github</a> or&hellip;</li>
<li>You can <a href="http://nameless-spire-1402.herokuapp.com/">try a demo</a> too!</li>
<li>And if you are too lazy to try it, here you have an screenshot:</li>
</ul>
<p><img alt="image" src="/hovercraft.png"></p>
<h2 id="thanks">Thanks!</h2>
<p>I really want to thank <a href="http://www.paylogic.nl">Paylogic</a> for letting us
a place where to do the project and for provide us food &amp; beers. What a
developer will develop without food and beer?</p>
<p>I want to thank too all the guys that &ldquo;spend&rdquo; the weekend with me having
fun, but working hard too!</p>
<h2 id="conclusions">Conclusions</h2>
<p>The good point of all this editing is that thanks to backbone and thanks
to the backend guys is saved without any action needed. The idea of this
full project was:</p>
<ol>
<li><strong>Have fun!</strong></li>
<li>Simplifying slide creation</li>
<li>Make it really simply to share those slides.</li>
</ol>
<p>I didn&rsquo;t want to go really depth into the development of this project,
<strong>I only wanted to give a quick overview of what we made in two days.</strong>
But if you are really interested on something more explained, let me
know on the comments and I will try to help you in all what I can.</p>
]]></content></item><item><title>backbone.js + underscore: small intro</title><link>https://agonzalezro.github.io/posts/backbone/</link><pubDate>Thu, 01 Nov 2012 00:00:00 +0000</pubDate><guid>https://agonzalezro.github.io/posts/backbone/</guid><description>Today, Oleg gave a talk about backbone at Paylogic. We were using it for a really fancy application inside our backoffice, it was quite funny write it and Oleg decided to share the knowledge.
I used the techtalk to take some notes and, since this piece of code will have no sense out of our backoffice, I&amp;rsquo;ve written a small example that you can find as a gist on my github.</description><content type="html"><![CDATA[<p>Today, <a href="http://twitter.com/olegpidsadnyi/">Oleg</a> gave a talk about
backbone at <a href="http://paylogic.nl/">Paylogic</a>. We were using it for a
really fancy application inside our backoffice, it was quite funny write
it and Oleg decided to share the knowledge.</p>
<p>I used the techtalk to take some notes and, since this piece of code
will have no sense out of our backoffice, I&rsquo;ve written a small example
that you can find as a <a href="https://gist.github.com/3982819">gist</a> on my
github. I will use it to explain to you some of the useful things that
you can do with backbone and underscore. Feel free to improve it.</p>
<p>This is only a introductory post, if you want advance stuff you should
go to the <a href="http://backbonejs.org/">backbone official documentation</a> &amp;
<a href="http://underscorejs.org/">underscore docs</a>.</p>
<h2 id="why">Why?</h2>
<p>Backbone is really useful when you make complex GUIs on client side. You
can make your code like in a desktop app using events to handle the
actions. It&rsquo;s not needed to pass around instances of parents views,
let&rsquo;s use only the events for that purpose, and let the child decide.</p>
<p>You have models too, that you can sync (or not) with the server.</p>
<h2 id="models">Models</h2>
<p>In backbone you can have local model and sync them with the server or
with local storage (not explained in this intro). In our example we
will:</p>
<ol>
<li>Create a collection to save our objects (type Item) in.</li>
<li>Create the model Item.</li>
<li>Create 2 object type Item inside this collection.</li>
<li>Render them.</li>
</ol>
<p>The 3 points can be made only with these lines of code. It&rsquo;s really
simple! (after know how to do it :p):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">Item</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Backbone</span>.<span style="color:#a6e22e">Model</span>.<span style="color:#a6e22e">extend</span>();
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">Items</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Backbone</span>.<span style="color:#a6e22e">Collection</span>.<span style="color:#a6e22e">extend</span>({
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">model</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Item</span>
</span></span><span style="display:flex;"><span>});
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">items</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Items</span>();
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">items</span>.<span style="color:#a6e22e">add</span>([{<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;foo&#34;</span>}, {<span style="color:#a6e22e">name</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;bar&#34;</span>}]);
</span></span></code></pre></div><p><strong>Note</strong>: Setting values in the objects With .set will trigger the event
change. You can silent it in case that needed, but it&rsquo;s really
useful, for example, to save it.</p>
<p><strong>Second note</strong>: backbone is f***ing clever! Imagine, you are changing a
name, if the name has changed on the collection, the event will be raised,
if not, it will not. This means that if you are editing, but finally
you change your mind and you didn&rsquo;t made any change, the event will
not be raised.</p>
<h2 id="events">Events</h2>
<p>They are really useful to remove dependencies between elements. For
example, with jQuery if you change a element from another, the first one
needs to know about the second. With backbone you can catch the event
with the child element and do whatever you want with it.</p>
<p>On the example of my <a href="https://gist.github.com/3982819">gist</a> I show an
alert box with the name of the element. But you could, for example,
change it to an editable input.</p>
<p>This is the code of the example:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ItemView</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Backbone</span>.<span style="color:#a6e22e">View</span>.<span style="color:#a6e22e">extend</span>({
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">events</span><span style="color:#f92672">:</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#e6db74">&#34;dblclick&#34;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;onDoubleClick&#34;</span>
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">onDoubleClick</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">ev</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">text</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">$</span>.<span style="color:#a6e22e">trim</span>(<span style="color:#a6e22e">$</span>(<span style="color:#a6e22e">ev</span>.<span style="color:#a6e22e">target</span>).<span style="color:#a6e22e">text</span>());
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">alert</span>(<span style="color:#e6db74">&#34;Hey! Why do you click on &#34;</span> <span style="color:#f92672">+</span> <span style="color:#a6e22e">text</span> <span style="color:#f92672">+</span> <span style="color:#e6db74">&#34;?&#34;</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">ev</span>); <span style="color:#75715e">//Play with this :)
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  }
</span></span><span style="display:flex;"><span>});
</span></span></code></pre></div><p>We are binding the <code>dblclick</code> event to the function <code>onDoubleClick</code>.
This function will receive the event, and the event will have the target
(in this case the <code>&lt;li/&gt;</code> that we are clicking.</p>
<h2 id="underscore">Underscore</h2>
<p>It&rsquo;s really useful to Work with collections. In out example we are using
it to iterate over the items:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">render</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">_</span>.<span style="color:#a6e22e">each</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">items</span>.<span style="color:#a6e22e">models</span>, <span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">item</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">itemview</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">new</span> <span style="color:#a6e22e">ItemView</span>(<span style="color:#a6e22e">item</span>);
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">$</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">el</span>).<span style="color:#a6e22e">append</span>(<span style="color:#a6e22e">itemview</span>.<span style="color:#a6e22e">render</span>().<span style="color:#a6e22e">el</span>);
</span></span><span style="display:flex;"><span>  }, <span style="color:#66d9ef">this</span>);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>If you read carefully this piece of code you will realize that we are
instantiating a new ItemView for each particular item, so it has its own
container element created on the fly, re-renderable each time when data
is updated and all events are delegated to this element.</p>
<p>The amazing thing that you can do with underscore is use templates (yes,
like jinja or django-templates, but in JS)! And we are doing it:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">var</span> <span style="color:#a6e22e">ItemView</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Backbone</span>.<span style="color:#a6e22e">View</span>.<span style="color:#a6e22e">extend</span>({
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">template</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">_</span>.<span style="color:#a6e22e">template</span>(<span style="color:#a6e22e">$</span>(<span style="color:#e6db74">&#34;#item-template&#34;</span>).<span style="color:#a6e22e">html</span>()),
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">render</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>     <span style="color:#a6e22e">$</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">el</span>).<span style="color:#a6e22e">html</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">template</span>(<span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">item</span>.<span style="color:#a6e22e">toJSON</span>()));
</span></span><span style="display:flex;"><span>     <span style="color:#66d9ef">return</span> <span style="color:#66d9ef">this</span>;
</span></span><span style="display:flex;"><span>  },
</span></span><span style="display:flex;"><span>  ...
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#f92672">script</span> <span style="color:#a6e22e">type</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;text/template&#34;</span> <span style="color:#a6e22e">id</span><span style="color:#f92672">=</span><span style="color:#e6db74">&#34;item-template&#34;</span>&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&lt;%=</span> <span style="color:#a6e22e">name</span> <span style="color:#f92672">%&gt;</span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#f92672">script</span>&gt;
</span></span></code></pre></div><h2 id="extra-ball">Extra ball</h2>
<p>Use <code>_.debounce</code> to don&rsquo;t call the functions thousands of times, example
drag&amp;dropping an element it will be useful.</p>
<p>For example in our project we had to sort with drag and drop some
elements of a list, instead send this event in each drag movement, we
made it after 200s being quiet with:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#a6e22e">onChange</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">_</span>.<span style="color:#a6e22e">debounce</span>(<span style="color:#66d9ef">function</span>(<span style="color:#a6e22e">ev</span>) {
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">this</span>.<span style="color:#a6e22e">pools</span>.<span style="color:#a6e22e">save</span>();
</span></span><span style="display:flex;"><span>}, <span style="color:#ae81ff">200</span>),
</span></span></code></pre></div><p>Please comment your thoughts about the post. We are all here to learn,
and it&rsquo;s really easy that I made some mistake explaining this.
Furhtermore, I know that my English is not really good, so, I will
apreciate constructive comments about it too :)</p>
<p>Enjoy it!</p>
]]></content></item></channel></rss>